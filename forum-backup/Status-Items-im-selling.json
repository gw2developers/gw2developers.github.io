{"title":"Status: Items im selling","pubDate":"2014-01-28T11:48:27.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling","comments":[{"pubDate":"2014-02-01T15:16:22.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling/3579775","author":"Healix.5819","body":"\n<p>Any language that is capable of reading files and network access would be capable of automating that script. Visual Basic, Java or C# could do it fairly easy. Visual Basic is more human readable, which may or may not be more confusing depending on if you’d rather see “If x Then y End If” or “if (x) { y }”. Java, C# and JavaScript all use a similar style, with C# being easier to make Windows applications, whereas Java is easier to make cross-platform applications.</p>\n<p>GW2Spidy uses PHP scripts which requires running a PHP capable web server. XAMP is an easy to setup all-in-one server if you wanted that. PHP’s style is similar to C++, which is a little more complex than Java/C#/JavaScript.</p>\n<p>All languages use relatively the same style, so once you’ve learned one you should be able to figure out the others. Choosing which one you want to start with is more up to choosing what you want to create (websites, windows or cross-platform apps).</p>","arenanet":false},{"pubDate":"2014-02-01T15:10:17.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling/3579758","author":"smiley.1438","body":"\n<p>PHP is easy to learn, very well documented and doesn’t require any compiling and stuff – just a local webserver (e.g. XAMPP) and web browser or the command line<img src=\"/include/images/smilies/wink.png\"></p>","arenanet":false},{"pubDate":"2014-02-01T10:56:06.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling/3579282","author":"Romek.4201","body":"\n<p>thx Healix.5819 for this guide – i will work on it<img src=\"/include/images/smilies/smile.png\"></p>\n<p>a Question – what language i should look into to automate this?</p>\n<p>can it be done with java? Or Visual Basic?<br>\nOr something like spidy but offline – can this be done with java or what would be better to learn?^^</p>","arenanet":false},{"pubDate":"2014-01-30T00:11:23.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling/3568945","author":"Ryan.9387","body":"\n<p>I think the OP wants this to be somewhat automated, rather than long and complex.</p>","arenanet":false},{"pubDate":"2014-01-29T11:08:05.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling/3565723","author":"Healix.5819","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on January 28 2014 04:35PM\"><a href=\"/forum/community/api/Status-Items-im-selling/3561783\">Romek.4201:</a></cite></div><div class=\"quotey\"><p>can you or someone guide me how i can get the “Items im Selling” as a csv file?</p></div></blockquote>\n<p>Without using any additional programs, this is how you can pull the listings in a comma separated format:</p>\n<p>I’m assuming you’re using <strong>Windows</strong> with <strong>IE7+, Firefox or Chrome</strong>.</p>\n<p>First, you need to know your session key. Start GW2 and open the trading post. Press <strong>CTRL+SHIFT+ESC</strong> to bring up the <strong>Window’s Task Manager</strong>. Under <strong>Processes</strong> look for a process named <strong>awesomium_process.exe</strong>. Note that the trading post window must be open in-game. Right click awesomium_process.exe and select <strong>Open File Location</strong>. This should bring up the <strong>gw2cache</strong> folder that stores the trading post’s cache files. In the folder should be a <strong>data</strong> folder and within that folder should be a <strong>Cookies</strong> file.</p>\n<p>Open the Cookies files using <strong>notepad</strong>. Search for the text <strong>tradingpost-live.ncplatform.nets</strong>. Your session key is the series of character between the <strong>s</strong> in <em>nets</em> and the <strong>/</strong>. Copy it. It should be in the format <em>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</em>. Note that there may be more than 1 unique session key in the file for the same domain. If this happens, you’ll have to use trial and error or close GW2, delete the Cookies file and start again.</p>\n<p>In IE7+, Firefox or Chrome, open the following url:</p>\n<blockquote><div class=\"quotey\"><pre><code>https://tradingpost-live.ncplatform.net/ws/me.json?time=now&amp;type=sell&amp;offset=1&amp;count=100</code></pre></div></blockquote>\n<p>You can replace the <em>&amp;count=100</em> with however many listings you want to pull. The page should display the text <em>ERROR: Invalid authorization</em>.</p>\n<p>In your browser, press <strong>F12</strong> to open the <strong>developer tools</strong>. Look for the <strong>Console</strong> tab. Under the console you should see an area to input text, noted by the <strong>&gt;</strong>. To run a script in the console, you either need to press <em>enter</em> or click a run/play button.</p>\n<p>The first code you want to run is to set your cookie. Take your session key from before and replace <em>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</em> in the following code with your key:</p>\n<blockquote><div class=\"quotey\"><pre><code>document.cookie = \"s=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\";</code></pre></div></blockquote>\n<p>Run the code and refresh the page. If using IE, you’ll need to close the developer tools and reopen it with F12 once the page has been refreshed. The page should now display a bunch of text instead of invalid authorization.</p>\n<p>Next, run the following code to format the JSON into CSV:</p>\n<blockquote><div class=\"quotey\"><pre><code>var o = JSON.parse(document.body.childNodes[0].innerHTML || document.body.innerHTML)\nvar s = \"#item_id, name, rarity, quantity, unit price, listings (buy), offering price, \"\n+ \"listings (sell), asking price, date posted&lt;br/&gt;\";\nfor (var i in o.listings) { var l = o.listings[i]; s += l.data_id + \", \\\"\" + l.name + \"\\\", \" + l.rarity_word + \", \" + l.quantity \n+ \", \" + l.unit_price + \", \" + l.buy_count + \", \" + l.buy_price + \", \" + l.sell_count + \", \" + l.sell_price + \", \" \n+ l.created + \"&lt;br/&gt;\" }\ndocument.body.innerHTML = s;</code></pre></div></blockquote>","arenanet":false},{"pubDate":"2014-01-29T08:48:30.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling/3565367","author":"multivira.7925","body":"\n<p>Aren’t there some modules lying about online to parse json in vba (something like <a href=\"https://code.google.com/p/vba-json/\">this</a> , haven’t personally checked it)? You’d think it would be a common enough problem. In the end you can make anything in VBA that you can make in any other programming language, so it should be entirely possible to do it in excel.</p>\n<p>As with making any custom tool, it’ll require some programming knowledge though.</p>","arenanet":false},{"pubDate":"2014-01-28T17:21:02.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling/3562041","author":"Ryan.9387","body":"\n<p>Json is impossible to manage in excel. I think your best option is to have some sort of a program that pulls API data, parses it into csv, and sends it to a text file excel reads.</p>","arenanet":false},{"pubDate":"2014-01-28T16:46:05.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling/3561835","author":"smiley.1438","body":"\n<p>this? <a href=\"https://forum-en.guildwars2.com/forum/community/api/Guide-to-the-Black-Lion-Trading-Co-API/\">https://forum-en.guildwars2.com/forum/community/api/Guide-to-the-Black-Lion-Trading-Co-API/</a></p>\n<p>(some programming skills may be required…)</p>","arenanet":false},{"pubDate":"2014-01-28T16:35:32.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling/3561783","author":"Romek.4201","body":"\n<p>oh thx darkspirit and very nice it is possible<br>\nbut i dont understand anything^^</p>\n<p>can you or someone guide me how i can get the “Items im Selling” as a csv file? (maby with a step by step for idiots or so<img src=\"/include/images/smilies/smile.png\"> )</p>\n<p>thx<img src=\"/include/images/smilies/smile.png\"></p>","arenanet":false},{"pubDate":"2014-01-28T13:49:55.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling/3560942","author":"DarkSpirit.7046","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on January 28 2014 11:48AM\"><a href=\"/forum/community/api/Status-Items-im-selling/3560554\">Romek.4201:</a></cite></div><div class=\"quotey\"><p>Is it possible to get the Status from my Items im actual selling in TP?</p>\n<p>i mean is it possible to have a list from all my items in TP?</p>\n<p>when yes, how can i get this data in an excel sheet?</p></div></blockquote>\n<p>The answer is yes, but I am not an excel expert so I don’t know how to get this data into excel. <img src=\"/include/images/smilies/smile.png\"></p>\n<p>To do this, you need to acquire your guild wars 2 client game session key.  Then set it in your cookie when communicating with the TP server.</p>\n<p>To view the number of items in your current sell list:</p>\n<p><a href=\"https://tradingpost-live.ncplatform.net/ws/me.json?time=now&type=sell&charid\">https://tradingpost-live.ncplatform.net/ws/me.json?time=now&amp;type=sell&amp;charid</a>=&lt;your character id guid&gt;&amp;offset=1&amp;count=&lt;how many records you want returned&gt;</p>\n<p>You can see your character’s id and your game session key through fiddler.  You need to keep your GW2 login session running in the background in order for the session key to not expire.</p>","arenanet":false},{"pubDate":"2014-01-28T11:48:27.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling/3560554","author":"Romek.4201","body":"\n<p>Is it possible to get the Status from my Items im actual selling in TP?</p>\n<p>i mean is it possible to have a list from all my items in TP?</p>\n<p>when yes, how can i get this data in an excel sheet?</p>","arenanet":false}]}