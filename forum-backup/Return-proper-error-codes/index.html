<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Return proper error codes</title>
  <meta name="description" content="Learn how to use the GW2 API.">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="/forum-backup/Return-proper-error-codes/">
  <link rel="alternate" type="application/rss+xml" title="GW2 Developers" href="/feed.xml">
  
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106748097-1', 'auto');
  ga('send', 'pageview');

</script>
  

  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/"><img src="/assets/images/logo.svg"></a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/forum-backup/">Forum Backup</a>
            
          
            
            
            <a class="page-link" href="/guides/">Guides</a>
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Return proper error codes</h1>
  </header>

  <div class="post-content">
    


<p class="post-meta">
    Original Url: http://forum-en.guildwars2.com/forum/community/api/Return-proper-error-codes
</p>



<h2 id="">Fror.2163:</h2>
<p class="post-meta">
    <time datetime="2013-05-22T14:20:30+00:00">
        22 May 2013
    </time>
</p>
<p>
<p>Hi,</p>
<p>I tried calling the following url: <a href="https://api.guildwars2.com/v1/wvw/match_details.json?match_id=1">https://api.guildwars2.com/v1/wvw/match_details.json?match_id=1</a> I received an error 500.</p>
<p>Since the match with id 1 doesn’t exist either, you should return an error 404, telling me that I made a mistake, not that you made an error while searching for the erroneous input I gave.</p></p>

<h2 id="">Ruhrpottpatriot.7293:</h2>
<p class="post-meta">
    <time datetime="2013-05-22T14:40:50+00:00">
        22 May 2013
    </time>
</p>
<p>
<p>Thumbs up for this.</p></p>

<h2 id="">The Talcmaster.7391:</h2>
<p class="post-meta">
    <time datetime="2013-05-22T14:51:03+00:00">
        22 May 2013
    </time>
</p>
<p>
<p>It wouldn’t be a 404, because that would mean the page match_details.json doesn’t exist.  A 400 (which some of them already use) would be a better choice, since that usually means a syntax error.  Since we’re on the subject of error codes, a 429 (Too Many Requests) would probably be a good idea if they ever feel the need to impose a rate limit on any part of the API</p></p>

<h2 id="">Fror.2163:</h2>
<p class="post-meta">
    <time datetime="2013-05-22T15:01:21+00:00">
        22 May 2013
    </time>
</p>
<p>
<p>The Talcmaster, you are wrong. 404 means that the resource cannot be found. This is typically a case where a resource cannot be found. See <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.5">http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.5</a></p></p>

<h2 id="">AlSquire.9203:</h2>
<p class="post-meta">
    <time datetime="2013-05-22T15:18:57+00:00">
        22 May 2013
    </time>
</p>
<p>
<p>404 seems a good choice to me, but it made me wonder if this is more relevant to an URI without a querystring (something like <a href="https://api.guildwars2.com/v1/wvw/match_details/1.json">https://api.guildwars2.com/v1/wvw/match_details/1.json</a> )</p>
<p>Seems not, as it is discussed here : <a href="http://stackoverflow.com/questions/3821663/querystring-in-rest-resource-url">http://stackoverflow.com/questions/3821663/querystring-in-rest-resource-url</a></p>
<p>Also I found this <a href="http://www.restapitutorial.com">site</a> which discuss REST API creation and <a href="http://www.restapitutorial.com/httpstatuscodekittenml">different status codes</a>. Can be useful.</p></p>

<h2 id="">Fror.2163:</h2>
<p class="post-meta">
    <time datetime="2013-05-22T15:34:32+00:00">
        22 May 2013
    </time>
</p>
<p>
<p>All the resources you show somehow use REST. This API doesn’t provide REST. So Anet is free to use the query string part.</p>
<p>The 404 is valid for a query string part since the HTTP protocol doesn’t say anything about that.</p></p>

<h2 id="">The Talcmaster.7391:</h2>
<p class="post-meta">
    <time datetime="2013-05-22T15:36:54+00:00">
        22 May 2013
    </time>
</p>
<p>
<p>Thank you for the technical correction on the definition of a 404, Fror.  Nonetheless, it doesn’t change the appropriateness of it as the error code to return.  I would say that if we were using a myriad slashes to locate something (as AlSquire pointed out) that it would be more appropriate to use a 404.  Since we are passing parameters, I would say it makes more sense to use something else if a parameter is invalid.</p></p>

<h2 id="">AlSquire.9203:</h2>
<p class="post-meta">
    <time datetime="2013-05-22T16:04:19+00:00">
        22 May 2013
    </time>
</p>
<p>
<p>I was implying that the stackoverflow thread (especially the most voted answer) convince me that 404 is appropriate even with the id part in a querystring. But ultimately it’s an API design choice.</p>
<p>(I’m used to the /stuff/id pattern so ?xxx_id=123 feels a little weird to me ^^)</p></p>

<h2 id="">Cliff Spradlin.3512:</h2>
<p class="post-meta">
    <time datetime="2013-05-22T16:04:45+00:00">
        22 May 2013
    </time>
</p>
<p>
<p>Having errors map to more specific HTTP status code is a good idea, but the reality is that we have many more complex error codes than we can map to HTTP statuses, and the errors may originate from backend servers that have no knowledge of HTTP.</p>
<p>Generally the way error handling should work is this:</p>
<pre><code>
result = get(/v1/events.json?event=123);
if (result != 200) {
    error = parseJson(resultBody);
    if (error)
        showErrorToUser(error);
    return;
}

</code></pre>
<p>Our error handling policy is to try to show the original error information to the user instead of hiding it. If a user reports a bug and includes the error code, there’s a good chance that we will be able to figure out the problem.</p>
<p>In other words, if you have a web server that talks to our API and returns results to a web browser, and you receive an error from us, try to send that error to the browser instead of swallowing it and generating your own error.</p>
<p>OK, on a separate topic this thread made me realize that error 500 was a bad choice. I propose changing the APIs to return error 400 instead.</p></p>

<h2 id="">AlSquire.9203:</h2>
<p class="post-meta">
    <time datetime="2013-05-22T22:56:44+00:00">
        22 May 2013
    </time>
</p>
<p>
<p>Sure, a 4xx is expected because it is client side error, and 400 fits with the error description “invalid match_id”, no objection.</p>
<p>Or maybe 418 is better… dunno.</p></p>

<h2 id="">zwei.9073:</h2>
<p class="post-meta">
    <time datetime="2013-05-24T15:33:10+00:00">
        24 May 2013
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on May 22 2013 04:04PM"><a href="/forum/community/api/Return-proper-error-codes/2073965">Cliff Spradlin.3512:</a></cite></div><div class="quotey"><p>Having errors map to more specific HTTP status code is a good idea, but the reality is that we have many more complex error codes than we can map to HTTP statuses, and the errors may originate from backend servers that have no knowledge of HTTP.</p></div></blockquote>
<p>You can only have fairly generic mapper and still give full error report in body of document, just like you do with code 500</p>
<blockquote><div class="citey"><cite title="Posted on May 22 2013 04:04PM"><a href="/forum/community/api/Return-proper-error-codes/2073965">Cliff Spradlin.3512:</a></cite></div><div class="quotey"><p>In other words, if you have a web server that talks to our API and returns results to a web browser, and you receive an error from us, try to send that error to the browser instead of swallowing it and generating your own error.</p></div></blockquote>
<p>I think that “item not found” should not be considered error.</p>
<p>Or rather, it is error in use of API by third party rather than error in service and as such is not error message, but info message for them.</p>
<p>Of course, it is often difficult to determine which is which.</p></p>

<h2 id="">Stefan Larimore.6872:</h2>
<p class="post-meta">
    <time datetime="2013-09-26T19:36:42+00:00">
        26 Sep 2013
    </time>
</p>
<p>
<p>Hi There,</p>
<p>I’d like to address this 500 error problem a bit:</p>
<p>My proposal is to only return 500 on a relatively small set of known internal errors.  Otherwise, I assume it is user error and return 400.  I thought about trying to map to more granular HTTP errors, but as Cliff posted above it is a difficult and un-maintainable job.</p>
<p>With my proposed fix, it is still possible that I missed a few “internal” errors which will come back as 400.  But as before, the error details will be provided in both 400 and 500 cases.   I can always add more errors to the “internal” set as needed.  In general, there are many more “user-error” than “internal-error” type codes in our system.</p>
<p>When authenticated APIs come out, I will likely introduce the 401 error code as well.</p>
<p>Any thoughts on this?</p></p>

<h2 id="">Lil Puppy.5216:</h2>
<p class="post-meta">
    <time datetime="2013-10-02T12:49:21+00:00">
        02 Oct 2013
    </time>
</p>
<p>
<p>If I request an id that doesn’t exist, that is the designers problem for deleting items and not using the ID again; but since it doesn’t exist, a 404 is expected on my front end so I can tell the user that item doesn’t exist.</p>
<p>If there is actually an internal error on the server I expect a 5xx.</p>
<p>All other errors are my fault and should be 4xx and I don’t particularly care which one since I’m only checking for the first number of the error code (4).<br>
In all those cases and timeouts, the user doesn’t get to see anything and ultimately it is my problem for not getting the data properly.</p>
<p>It is nice to get 5xx so I can tell the user that the service is currently down or the more friendly: “We are experiencing high demand at the moment, please check back in a few minutes”.</p>
<p>A non 404 4xx probably means I screwed up and I’ll try one more time to get the data just in case it wasn’t me. A second fail without a 404 and I tell the user “Please check your spelling…”<img src="/include/images/smilies/wink.png"></p>
<p>I only really care about 200, 404, and 500. Anything else is extraneous programming on both our parts. If an error happened, toss me some more detailed info and we’re both happy<img src="/include/images/smilies/smile.png"> The number of the error doesn’t do me much good but the detail info does both of us good.</p></p>

<h2 id="">smiley.1438:</h2>
<p class="post-meta">
    <time datetime="2013-10-02T15:20:35+00:00">
        02 Oct 2013
    </time>
</p>
<p>
<p>I don’t usually quote myself but i think it fits this topic:</p>
<blockquote><div class="quotey"><p>The 500 error which is thrown on any API error is somewhat misleading anyway. No matter if it’s a user error like wrong or missing params (could possibly end up in a 416), items not found (maybe a 416 as well, a 404 would be inappropirate) or “real” server errors (which are actually 500).</p></div></blockquote>
<p><a href="/forum-backup/Bug-in-Items-api">https://forum-en.guildwars2.com/forum/community/api/Bug-in-Items-api/2622811</a></p></p>

<h2 id="">Dr Ishmael.9685:</h2>
<p class="post-meta">
    <time datetime="2013-10-02T16:31:53+00:00">
        02 Oct 2013
    </time>
</p>
<p>
<p>I don’t really understand why HTTP errors are being returned at all, except for explicit 5xx server errors and 404 errors for non-existent endpoints (e.g. /v1/character_data.json).  (And 401 for authentication issues on OAuth2-enabled endpoints.)  As I see it, an API error is not an HTTP error – the endpoint was reached successfully, so the HTTP status should always be 200.  If the client supplied misspelled parameter names or invalid parameter values, those errors should be returned in the JSON content, not as an HTTP error code.</p>
<p>It seems like this would simplify things a bit.  At the HTTP level, the client only needs to worry about handling 5xx and 404 error codes, which indicate that no response can be returned at all.  Any other valid request should return HTTP 200, in which case  the client should then check the JSON content to see if an API error was returned.</p></p>

<h2 id="">Stefan Larimore.6872:</h2>
<p class="post-meta">
    <time datetime="2013-10-03T18:54:45+00:00">
        03 Oct 2013
    </time>
</p>
<p>
<p>Thanks for the feedback guys.</p>
<p>Dr. Ishmael, your argument is interesting: just return 200, 404, and 5XX and let the caller parse the results for details.</p>
<p>However, I do think keeping 200 for truly ‘success’ cases makes sense because internally we have one-and-only-one ‘success’ code used across the gw2.  So this will always translate correctly and it doesn’t prevent anyone who wants to treat 4XX and 200 the same, relying instead on parsing the JSON for errors.</p></p>


  </div>

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">GW2 Developers</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              GW2 Developers
            
            </li>
            
            <li><a href="mailto:gw2developers@darthmaim.de">gw2developers@darthmaim.de</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/gw2developers"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">gw2developers</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/gw2api"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">gw2api</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Learn how to use the GW2 API.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
