{"title":"Precondition Error When Reading Pages","pubDate":"2015-07-24T17:39:27.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Precondition-Error-When-Reading-Pages","comments":[{"pubDate":"2015-08-08T10:35:16.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Precondition-Error-When-Reading-Pages/5359353","author":"StevenL.3761","body":"\n<p>You discovered a bug in the code :/</p>\n<p>The ItemStack class was programmed to throw an exception when you try to set ItemStack.Count to a value greater than 255, which is the in-game size limit for item stacks.</p>\n<p>What I think is happening is that certain recipes require more than 255 of an ingredient.</p>\n<p>I don’t know why the same exception would occur for /v2/items, but basically any time you’re dealing with more than 255 of an item, it will crash.</p>","arenanet":false},{"pubDate":"2015-08-06T12:58:28.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Precondition-Error-When-Reading-Pages/5352845","author":"cawtx.2016","body":"\n<p>Additional info.<br>\nI use Visual Studio 2015, the released community version, and .net 4.5.2. I run the program in debug mode and the code above was copied directly from the project.cs. With page_size set to 200 the collection count is 45. The error for recipes occurs around page numbers 40-41. With recipes I get the single exception and with items I have several.</p>\n<p>I loaded GW2NET using the Nuget package manager in VS. The documentation states the version of the API is 1.0.1.</p>","arenanet":false},{"pubDate":"2015-08-05T23:52:44.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Precondition-Error-When-Reading-Pages/5351693","author":"cawtx.2016","body":"\n<p>The exception occurs with recipes and items, but I have not seen it with prices or discovery. On the exception i lose the 200 pages. If I do one page at a time, the exception still occurs but I lose only the one item. The complete code edited in VS 2015</p>\n<p>using System;<br>\nusing GW2NET;<br>\nusing GW2NET.Common;<br>\nusing System.IO;</p>\n<p>namespace TestGW2NET<br>\n{<br>\n    class TestGW2NET<br>\n    {<br>\n        static void Main(string[] args)<br>\n        {<br>\n            var service = GW2.V2.Recipes.ForDefaultCulture();</p>\n<p>foreach (var item in service.FindAllPages(200, 45))<br>\n            {<br>\n                try<br>\n                {<br>\n                    foreach (var _r in item.Value)<br>\n                    {<br>\n                        Console.Write(“\\r{0}”, _r.RecipeId.ToString());<br>\n                    }<br>\n                }<br>\n                catch (Exception ex)<br>\n                {<br>\n                    using (StreamWriter outfile = new StreamWriter(@\"C:\\Users\\Public\\StackTrace.txt\"))<br>\n                    {<br>\n                        outfile.WriteLine(ex.StackTrace.ToString());<br>\n                }<br>\n}<br>\n }<br>\n            Console.WriteLine(“\\r\\nDone”);<br>\n            Console.ReadKey():<br>\n }<br>\n}<br>\n}</p>\n<p>The stacktrace from the exception<br>\n   at GW2NET.Items.ItemStack.set_Count(Int32 value)<br>\n   at GW2NET.V2.Recipes.ConverterForItemStack.Convert(IngredientDataContract value)<br>\n   at System.Linq.Enumerable.WhereSelectListIterator`2.MoveNext()<br>\n   at System.Collections.Generic.List`1.InsertRange(Int32 index, IEnumerable`1 collection)<br>\n   at GW2NET.Common.Converters.ConverterForCollection`2.Convert(ICollection`1 value)<br>\n   at GW2NET.V2.Recipes.ConverterForRecipe.Convert(RecipeDataContract value)<br>\n   at System.Linq.Enumerable.WhereSelectListIterator`2.MoveNext()<br>\n   at System.Collections.Generic.List`1.InsertRange(Int32 index, IEnumerable`1 collection)<br>\n   at GW2NET.Common.ConverterForCollectionPageResponse`2.GW2NET.Common.IConverter&lt;GW2NET.Common.IResponse&lt;System.Collections.Generic.ICollection&lt;TDataContract&gt;&gt;,GW2NET.Common.ICollectionPage&lt;TValue&gt;&gt;.Convert(IResponse`1 value)<br>\n   at GW2NET.V2.Recipes.RecipeRepository.GW2NET.Common.IPaginator&lt;GW2NET.Recipes.Recipe&gt;.FindPage(Int32 pageIndex, Int32 pageSize)<br>\n   at GW2NET.Common.Paginator.&lt;&gt;c__DisplayClassc`1.&lt;FindAllPages&gt;b__9()<br>\n   at System.Lazy`1.CreateValue()<br>\n   at System.Lazy`1.LazyInitValue()<br>\n   at System.Lazy`1.get_Value()<br>\n   at TestGW2NET.TestGW2NET.Main(String[] args) in C:\\Users\\Public\\Documents\\Visual Studio 2015\\Projects\\GW2API\\TestGW2NET\\TestGW2NET.cs:line 18</p>","arenanet":false},{"pubDate":"2015-07-29T17:55:41.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Precondition-Error-When-Reading-Pages/5331462","author":"StevenL.3761","body":"\n<p>Can you post a full stack trace? The problem is not evident just by looking at the code.<br>\nDoes the same problem occur with the FindAllPagesAsync variants?</p>","arenanet":false},{"pubDate":"2015-07-29T17:34:02.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Precondition-Error-When-Reading-Pages/5331372","author":"StevenL.3761","body":"\n<p>GW2.NET dev here</p>\n<p>I don’t remember why there is a range limit of 256, but the exception seems to indicate a bug in `FindAllPages`. I’ll look into it. For now, please use ‘FindPage’ instead.</p>","arenanet":false},{"pubDate":"2015-07-26T22:38:28.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Precondition-Error-When-Reading-Pages/5321362","author":"UnknownFreak.2805","body":"\n<p>I have not worked with gw2net, so I cannot really help :&lt;<br>\nyou could try if( page.Value &gt;=256) break;<br>\nBut I doubt that will work. Sorry for not able to help you, but I have not worked with GW2NET, or I tried use it, and found it highly confusing so I made my own wrapper in c++.<br>\nedit: only works if page.value is a number type (integer, float, double, etc.)</p>","arenanet":false},{"pubDate":"2015-07-25T12:37:03.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Precondition-Error-When-Reading-Pages/5317438","author":"cawtx.2016","body":"\n<p>The exception occurs with both recipes and items. I added the try/catch after the fact to catch unhandled exceptions. The exception is System.ArgumentOutOfRange. The error message is:<br>\nPrecondition: value &lt; 256<br>\nParameter name: value<br>\nActual value was 500.</p>\n<p>The statement throwing the exception is “foreach (var _r in page.Value)”  which iterates through the data from “service.FindAllPages(ctx.PageSize, ctx.PageCount)” which, I believe, is from GW2NET.</p>","arenanet":false},{"pubDate":"2015-07-24T22:40:02.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Precondition-Error-When-Reading-Pages/5316044","author":"UnknownFreak.2805","body":"\n<p>It’s the way exceptions work, are you doing anything with the foreach (var r in page.Value)<br>\n{<br>\nyou should probably use the try catch in here<br>\n}</p>\n<p>if possible check if any of the functions have a throw exception somewhere in the documention, commenting or whatever, I assume you use the c# gw2.Net wrapper?</p>\n<p>You should try find a more “proper” exception to catch (if there are any) like</p>\n<p>// class def<br>\nclass foo<br>\n{<br>\nprivate bar;<br>\npublic void foobar() {<br>\nthrow fooException();<br>\n}<br>\n}<br>\nclass fooException : public Exception<br>\n{<br>\nexception stuff<br>\n}</p>\n<p>// example with above class</p>\n<p>try foo.foobar();<br>\n{<br>\ncatch fooException fooEx<br>\n{<br>\n}<br>\ncatch Exception ex<br>\n{<br>\n}</p>\n<p>(I skipped some of the code formatting), and I am not sure if I used the correct class definition for inheritance (I know it is that way in c++)</p>\n<p>also if possible post the exception message, it may help.</p>\n<p>you could try move the try catch into the for loop (the one the error occurs in), since when it catches it will break the loop, atleast the way you have done it now.</p>","arenanet":false},{"pubDate":"2015-07-24T17:39:27.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Precondition-Error-When-Reading-Pages/5314932","author":"cawtx.2016","body":"\n<p>When using FindAllPages () for Items or Recipes I get the error:<br>\n    Precondition: value &lt; 256<br>\n    Parameter name: value<br>\n    Actual value was 500.</p>\n<p>The underlined bold code generates the exception. The exception seems to lose one page of data. For example, with recipes the Discovery() count is 9050, but after the error I only stored 8850 recipes. Any thoughts?</p>\n<p>var service = GW2.V2.Recipes.ForDefaultCulture();<br>\n           IPageContext ctx = service.FindPage(pageSize: 200, pageIndex: 0);<br>\n           try<br>\n            {<br>\n                foreach (var page in service.FindAllPages(ctx.PageSize, ctx.PageCount))<br>\n                {<br>\n                    try<br>\n                    {<br>\n                        <strong><ins>foreach (var _r in page.Value)</ins></strong> {      }<br>\n                    }<br>\n                    catch (Exception ex) { Console.WriteLine(“Inner foreach: {0}”,ex.Message); }<br>\n                }<br>\n            }<br>\n            catch (Exception ex)  { Console.WriteLine(“Outer foreach: {0}”,ex.Message); }</p>","arenanet":false}]}