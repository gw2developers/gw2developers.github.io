<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>authorization header and preflight requests</title>
  <meta name="description" content="Learn how to use the GW2 API.">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="/forum-backup/authorization-header-and-preflight-requests/">
  <link rel="alternate" type="application/rss+xml" title="GW2 Developers" href="/feed.xml">
  
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106748097-1', 'auto');
  ga('send', 'pageview');

</script>
  

  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/"><img src="/assets/images/logo.svg"></a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/forum-backup/">Forum Backup</a>
            
          
            
            
            <a class="page-link" href="/guides/">Guides</a>
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">authorization header and preflight requests</h1>
  </header>

  <div class="post-content">
    


<p class="post-meta">
    Original Url: http://forum-en.guildwars2.com/forum/community/api/authorization-header-and-preflight-requests
</p>



<h2 id="">lynnae.4095:</h2>
<p class="post-meta">
    <time datetime="2015-06-17T20:29:31+00:00">
        17 Jun 2015
    </time>
</p>
<p>
<p>using javascript XMLHttpRequest and setting the Authorization header via xhr.setRequestHeader(‘Authorization’,’Bearer ’ + token); <br>
causes a preflight request to be sent because Authorization is considered to be a custom header.</p>
<p>Unfortunately the preflight request doesn’t look to be handled and Chrome reports:<br>
XMLHttpRequest cannot load <a href="https://api.guildwars2.com/v2/account">https://api.guildwars2.com/v2/account</a>. No ‘Access-Control-Allow-Origin’ header is present on the requested resource.</p>
<p>Is this to be expected, and XMLHttpRequest can’t be used to access the protected resources, or do I have the wrong end of the stick for setting the bearer token? Or have the CORS headers gone walkabout?<img src="/include/images/smilies/smile.png"></p></p>

<h2 id="">StevenL.3761:</h2>
<p class="post-meta">
    <time datetime="2015-06-17T21:07:54+00:00">
        17 Jun 2015
    </time>
</p>
<p>
<p><del>I can confirm that /v2/account does not respond with the ‘Access-Control-Allow-Origin’ header.</del> Wait… it does. Maybe it only works for GET requests.</p></p>

<h2 id="">smiley.1438:</h2>
<p class="post-meta">
    <time datetime="2015-06-17T22:37:55+00:00">
        17 Jun 2015
    </time>
</p>
<p>
<p>Don’t even try to use custom headers when using CORS requests – just append <strong>access_token=&lt;API_KEY&gt;</strong> to the request URL. Also, preflight requests are not supported.</p></p>

<h2 id="">Eearslya.6309:</h2>
<p class="post-meta">
    <time datetime="2015-06-17T22:38:33+00:00">
        17 Jun 2015
    </time>
</p>
<p>
<p>I believe I’ve seen this issue posted before. The solution I saw then was to pass the API key as <strong>?access_token=APIKEY</strong> instead of in the header. Not a perfect solution, but it’s probably your best bet.</p></p>

<h2 id="">lynnae.4095:</h2>
<p class="post-meta">
    <time datetime="2015-06-18T07:45:09+00:00">
        18 Jun 2015
    </time>
</p>
<p>
<p>ta folks.</p>
<p>Since sending the preflight request is not something you can control when you set the Authorization header in javascript, I’ll try appending it to the query string as indicated.</p>
<p>ta for the tip, think this was the post that shows the query string key <a href="/forum-backup/Cross-Origin-v2-transactions">https://forum-en.guildwars2.com/forum/community/api/Cross-Origin-v2-transactions</a></p>
<p>and the original dev post response that preflight requests are not supported and listing the query string workaround:<br>
<a href="/forum-backup/Launching-v2-commerce-transactions">https://forum-en.guildwars2.com/forum/community/api/Launching-v2-commerce-transactions/first#post5077482</a></p></p>

<h2 id="">smiley.1438:</h2>
<p class="post-meta">
    <time datetime="2015-06-18T08:31:03+00:00">
        18 Jun 2015
    </time>
</p>
<p>
<p>However, you should avoid to use the API key via frontend scripting languages (as in JavaScript). Keep in mind that it is basically the OAuth2 access token which is intended to be used between the app`s backend and the gw2 API server.</p></p>

<h2 id="">lynnae.4095:</h2>
<p class="post-meta">
    <time datetime="2015-06-18T09:09:39+00:00">
        18 Jun 2015
    </time>
</p>
<p>
<p>:) thanks. I’m aware.</p></p>

<h2 id="">Wizeon.3852:</h2>
<p class="post-meta">
    <time datetime="2015-06-26T16:25:20+00:00">
        26 Jun 2015
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on June 18 2015 08:31AM"><a href="/forum/community/api/authorization-header-and-preflight-requests/5167341">smiley.1438:</a></cite></div><div class="quotey"><p>However, you should avoid to use the API key via frontend scripting languages (as in JavaScript). Keep in mind that it is basically the OAuth2 access token which is intended to be used between the app`s backend and the gw2 API server.</p></div></blockquote>
<p>Can you elaborate? The user has to send the api key via a frontend to the backend anyway, so it’s just as easily compromised at that point. And by not using a backend I basically guarantee to the user that I won’t do anything with their api keys since I don’t even see them. Not even talking about the time saved by not having to have a backend<img src="/include/images/smilies/colondee.png"></p></p>

<h2 id="">Lawton Campbell.8517:</h2>
<p class="post-meta">
    <time datetime="2015-06-26T19:44:59+00:00">
        26 Jun 2015
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on June 18 2015 08:31AM"><a href="/forum/community/api/authorization-header-and-preflight-requests/5167341">smiley.1438:</a></cite></div><div class="quotey"><p>However, you should avoid to use the API key via frontend scripting languages (as in JavaScript). Keep in mind that it is basically the OAuth2 access token which is intended to be used between the app`s backend and the gw2 API server.</p></div></blockquote>
<p>Eh, it’s not that big of a deal with the current API keys. With OAuth2, the access token was tied to the application so that e.g., an application could be billed or rate-limited. As such, OAuth2 applications need to ensure they never leak the access token to the user because that would allow the user to pretend they’re the application and make requests using that application’s credentials.</p>
<p>Since API keys aren’t tied to applications, there’s no need for an application to prevent the user from getting access to them.</p></p>


  </div>

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">GW2 Developers</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              GW2 Developers
            
            </li>
            
            <li><a href="mailto:gw2developers@darthmaim.de">gw2developers@darthmaim.de</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/gw2developers"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">gw2developers</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/gw2api"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">gw2api</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Learn how to use the GW2 API.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
