<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Wish: Better searching</title>
  <meta name="description" content="Learn how to use the GW2 API.">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="/forum-backup/Wish-Better-searching/">
  <link rel="alternate" type="application/rss+xml" title="GW2 Developers" href="/feed.xml">
  
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106748097-1', 'auto');
  ga('send', 'pageview');

</script>
  

  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/"><img src="/assets/images/logo.svg"></a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/forum-backup/">Forum Backup</a>
            
          
            
            
            <a class="page-link" href="/guides/">Guides</a>
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Wish: Better searching</h1>
  </header>

  <div class="post-content">
    


<p class="post-meta">
    Original Url: http://forum-en.guildwars2.com/forum/community/api/Wish-Better-searching
</p>



<h2 id="">Killerassel.2197:</h2>
<p class="post-meta">
    <time datetime="2015-11-15T10:16:27+00:00">
        15 Nov 2015
    </time>
</p>
<p>
<p>There are two things I have noticed lately on using the API. I’d like to be able to find an item by its name and the recipes by discipline and possibly min_rating. An example use case: which recipes for scribes use T1 blood?</p>
<p>Of course it would be even better the more general the search options are. Ideally it would be possible to find by every aspect that is included in the result, such as items by type, flags, details, rarity etc. For example: find all level 80 heavy armor boots that give power (and any other stats).</p>
<p>This would rather be a convenience (and performance) feature. To get my list of scribing recipes I just pulled all the recipes and filtered them by discipline. The same approach can be used to find an item by name. And of course I could cache it in a local database. But I think it would be nice if one could just ask the API for it directly.</p>
<p>Oh, and item by name should at least optionally be partial name, just like on the TP.</p></p>

<h2 id="">DarkMagister.7429:</h2>
<p class="post-meta">
    <time datetime="2015-11-18T13:17:57+00:00">
        18 Nov 2015
    </time>
</p>
<p>
<p>I think let not try to sit on anet’s head here )) They are providing us with some nice info to use, but if all the sites or programs start requesting anet’s server for all these things – it would not be so good.</p>
<p>“which recipes for scribes use T1 blood?” – way I remember there is an API to return the list of recipes using the item, then you can go through that short list to check which of them is for scribe.</p>
<p>BUT I doubt that API provides recursive check, nor will any other API of that kind. I mean “A is used for crafting B, B is used for crafting C. You won’t get C in the response list for A”. So it is something you will still need to do on your side.</p></p>

<h2 id="">Lawton Campbell.8517:</h2>
<p class="post-meta">
    <time datetime="2015-11-18T18:36:06+00:00">
        18 Nov 2015
    </time>
</p>
<p>
<p>This is something we’ve looked into but are unlikely to support, unfortunately.</p></p>

<h2 id="">Killerassel.2197:</h2>
<p class="post-meta">
    <time datetime="2015-11-22T13:10:07+00:00">
        22 Nov 2015
    </time>
</p>
<p>
<p>DarkMagister, you’ve read too much into my post. The API already supports listing recipes by (immediate) ingredient or by result. It takes the item ID as parameter, though. So, what I need is a way to translate the name of an item into its ID, i.e. a search item by name function.</p>
<p>I’d consider recursion through recipes my application’s job anyway.</p>
<p>My problem with with the API as it is now is, that I cannot search an item or a recipe by specific properties directly. For recipes specifically, I can ask by ingredient or result, but I cannot filter by discipline or min-level.</p>
<p>I.e. I CAN ask “show all recipes using item 12345”, but I cannot ask “show all recipes for scribes (using item 12345)”.</p>
<p>The workaround that I can use is pulling ALL items/recipes and filter locally.</p>
<p>Unfortunately this workaround will have to do for the forseeable future. Thanks for the feedback anyway and keep up the nice work.</p></p>

<h2 id="">DarkMagister.7429:</h2>
<p class="post-meta">
    <time datetime="2015-11-22T13:28:18+00:00">
        22 Nov 2015
    </time>
</p>
<p>
<p>Maybe I’ve read too much, but I meant what it:<br>
ANet is interested in moving as much search job to our side, instead of loading its servers. Thus it is reasonable for them to leave such complex searches to our side.<br>
(this may not be a problem on their side, but I see some requests dropped in the prime-time already)</p>
<p>And if you already consider recursion to be done on your side anyway, why do you need any search at the server-side? To first get recipe-list from the server, then use your recursive function (returning recipes, using this item) on the results from this list – it is counter-productive.</p>
<p>P.S. Trying to use recursive search on MF recipes will need additional fail-safes added.</p></p>

<h2 id="">Killerassel.2197:</h2>
<p class="post-meta">
    <time datetime="2015-11-28T13:32:55+00:00">
        28 Nov 2015
    </time>
</p>
<p>
<p>At the recursion stage I’m already working with IDs. At that time I won’t need (other) search conditions anymore.</p>
<p>Consider the following two questions and how you’d answer them from the API:</p>
<ul>
	<li>What can I craft from mithril ore?</li>
	<li>What recipes can my Scribe (level xx) craft?</li>
</ul>
<p>There is already /recipes/search?input=…, which allows to query “What can I craft from the item with ID 1234?” So to find out what I can craft from mithril ore I need to find its ID first. And this is not directly possible via the API, other than loading ALL items and check each item’s name.</p>
<p>Similar for the second question. I can get a list of all recipes and each recipe states its discipline(s). But I cannot query, say, /recipes/search?discipline=Scribe.</p>
<p>Once I have recipes I need to find what the item IDs actually represent and possibly how to craft them. This is the recursion step, but this can be done without search but directly querying items by their ID and recipes by /recipes/search?output=…, which exists.</p>
<p>To put it in SQL terms, I’d like to have more options/indexes for WHERE conditions, but my post was not at all about JOIN (i.e. recursion).</p>
<p>And about the server load: well, it’s a trade off. My suggestion would put a bit more load for processing, but take away a lot of load on bandwidth. Unless, of course, high bandwidth sites start to abandon their local caches and start hammering the server.</p></p>

<h2 id="">Lawton Campbell.8517:</h2>
<p class="post-meta">
    <time datetime="2015-12-01T15:23:30+00:00">
        01 Dec 2015
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on November 28 2015 01:32PM"><a href="/forum/community/api/Wish-Better-searching/5804476">Killerassel.2197:</a></cite></div><div class="quotey"><p>To put it in SQL terms, I’d like to have more options/indexes for WHERE conditions, but my post was not at all about JOIN (i.e. recursion).</p></div></blockquote>
<p>The API doesn’t talk to any relational databases; the recipe search endpoints are using hand-rolled indexes. This doesn’t really scale in a sane way; it would be ideal to toss all of the data into a more production-ready indexing solution (read: hand-normalize it into SQL, or toss is into an indexed document store ala Lucene) but we don’t really have the resources to set up and maintain additional third-party software solutions.</p></p>

<h2 id="">Arridath.1087:</h2>
<p class="post-meta">
    <time datetime="2015-12-02T00:40:53+00:00">
        02 Dec 2015
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on December 01 2015 03:23PM"><a href="/forum/community/api/Wish-Better-searching/5813047">Lawton Campbell.8517:</a></cite></div><div class="quotey"><p>The API doesn’t talk to any relational databases; the recipe search endpoints are using hand-rolled indexes. This doesn’t really scale in a sane way; it would be ideal to toss all of the data into a more production-ready indexing solution (read: hand-normalize it into SQL, or toss is into an indexed document store ala Lucene) but we don’t really have the resources to set up and maintain additional third-party software solutions.</p></div></blockquote>
<p>Oh my god I am so sorry this is the case.</p>
<p>With regards to OP’s request, the GW2Spidy API might be of use. They poll the official API and keep all of their data in a separate database. Because of this, they support searching for an item by name.</p></p>

<h2 id="">Killerassel.2197:</h2>
<p class="post-meta">
    <time datetime="2015-12-02T12:22:35+00:00">
        02 Dec 2015
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on December 01 2015 03:23PM"><a href="/forum/community/api/Wish-Better-searching/5813047">Lawton Campbell.8517:</a></cite></div><div class="quotey"><p>The API doesn’t talk to any relational databases;</p></div></blockquote>
<p>I had almost expected that. But I thought putting it in familiar SQL terms anyway helped me to clarify what I’m asking for and clear up the confusion DarkMagister pointed at.</p>
<blockquote><div class="citey"><cite title="Posted on December 01 2015 03:23PM"><a href="/forum/community/api/Wish-Better-searching/5813047">Lawton Campbell.8517:</a></cite></div><div class="quotey"><p>This doesn’t really scale in a sane way; it would be ideal to toss all of the data into a more production-ready indexing solution (read: hand-normalize it into SQL, or toss is into an indexed document store ala Lucene) but we don’t really have the resources to set up and maintain additional third-party software solutions.</p></div></blockquote>
<p>Ouch.<img src="/include/images/smilies/colondee.png"> Ok, but since there is an index to find recipes by ingredient and output, at least there was some hope this would be doable.</p>
<blockquote><div class="citey"><cite title="Posted on December 02 2015 12:40AM"><a href="/forum/community/api/Wish-Better-searching/5816014">Arridath.1087:</a></cite></div><div class="quotey"><p>With regards to OP’s request, the GW2Spidy API might be of use.</p></div></blockquote>
<p>Thank you for the suggestion. Yes, this would be another good option.</p></p>

<h2 id="">DarkMagister.7429:</h2>
<p class="post-meta">
    <time datetime="2015-12-03T20:19:45+00:00">
        03 Dec 2015
    </time>
</p>
<p>
<p>Seems like things are more evident now, but since it was asked.</p>
<blockquote><div class="citey"><cite title="Posted on November 28 2015 01:32PM"><a href="/forum/community/api/Wish-Better-searching/5804476">Killerassel.2197:</a></cite></div><div class="quotey"><p>Consider the following two questions and how you’d answer them from the API:</p>
<ul>
	<li>What can I craft from mithril ore?</li>
	<li>What recipes can my Scribe (level xx) craft?</li>
</ul></div></blockquote>
<p>I develop my tool as an application, not a web-project, so for me running though some lists or dictionaries looks like a faster way to get things done, then requesting server for each action.</p>
<p>Question 1: It can be split into two different actions, first being an addition to the second:<br>
1. Connect user input “Mithril Ore” with the item ID (if it is a user input and we don’t know the ID). I’ve added it not so long ago, so: I have two lists: one if integer – IDs, second of string (item names). The search function creates the list of indexes of items in the 2nd list, containing “Mithril Ore”, then converts it into the list of item IDs from the 1st list (item #10 corresponds to the item #10), so the list of item IDs is returned to the table, from which Mithril Ore can be selected – we get our ID.<br>
2. Code:<br>
</p><pre><code>Public Function GetRecipesUsingItem(i_ItemID As Integer) As List(Of cls_HolderAPI2RecipeDetails)
        Dim lst_return As New List(Of cls_HolderAPI2RecipeDetails)
        For Each item In dic_RecipesDetails
            For Each item2 In item.Value.ingredients
                If item2.item_id = i_ItemID Then
                    Dim lst_LvlUPRecipes As New List(Of cls_HolderAPI2RecipeDetails)
                    lst_LvlUPRecipes = GetRecipesUsingItem(item.Value.output_item_id)
                    If lst_LvlUPRecipes IsNot Nothing Then
                        lst_return.AddRange(lst_LvlUPRecipes)
                    End If
                        lst_return.Add(item.Value)
                End If
            Next
        Next
        If lst_return.Count = 0 Then
            Return Nothing
        Else
            Return lst_return
        End If
End Function</code></pre><p></p>
<p>This recursive function returns the list of all recipes, in which the given item and its “children” are used as ingredients. Then another function converts it into the list of results item IDs, which is then converted into names at the stage of filling the result table. It can be converted directly, but the program works with IDs, not names, I only use names when it is something the user is to see.</p>
<p>Conversion to name is simple, item details are stored in the dictionary of item details classes, with item IDs being keys. So, for example<br>
[pre]msgbox (GetItemForID(i_ItemID).name)</p>
<p>Public Function GetItemForID(i_ID As Integer) As cls_HolderAPI2ItemDetails<br>
        If dic_ItemsDetails.ContainsKey(i_ID) = True Then<br>
            Return dic_ItemsDetails.Item(i_ID)<br>
        End If<br>
        Dim cls_ZeroResult As New cls_HolderAPI2ItemDetails<br>
        cls_ZeroResult.name = “N/A”<br>
        Return cls_ZeroResult<br>
    End Function[/pre]</p>
<p>“What recipes can my Scribe (level xx) craft?”<br>
I have a boolean function b_IsNeededDiscipline, that checks: is the given recipe corresponds to the given recipe search settings (discipline and level), like  Scribe (level xx) . It is used on several occasions, in your task it will be cycling through all the recipes, creating the list of recipes IDs, that correspond to the given setting.</p>
<p>I’m sorry for much text, and possibly sorry for stupid code – I’m not a pro.</p>
<p>P.S. I understand that using a local database would be the right way to do it, but had my reasons to do it this way.</p></p>


  </div>

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">GW2 Developers</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              GW2 Developers
            
            </li>
            
            <li><a href="mailto:gw2developers@darthmaim.de">gw2developers@darthmaim.de</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/gw2developers"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">gw2developers</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/gw2api"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">gw2api</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Learn how to use the GW2 API.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
