<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>[How to] Get chat code with item ID</title>
  <meta name="description" content="Learn how to use the GW2 API.">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="/forum-backup/How-to-Get-chat-code-with-item-ID/">
  <link rel="alternate" type="application/rss+xml" title="GW2 Developers" href="/feed.xml">
  
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106748097-1', 'auto');
  ga('send', 'pageview');

</script>
  

  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/"><img src="/assets/images/logo.svg"></a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/forum-backup/">Forum Backup</a>
            
          
            
            
            <a class="page-link" href="/guides/">Guides</a>
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">[How to] Get chat code with item ID</h1>
  </header>

  <div class="post-content">
    


<p class="post-meta">
    Original Url: http://forum-en.guildwars2.com/forum/community/api/How-to-Get-chat-code-with-item-ID
</p>



<h2 id="">Yoone.9461:</h2>
<p class="post-meta">
    <time datetime="2013-05-25T10:03:47+00:00">
        25 May 2013
    </time>
</p>
<p>
<p>Hello!</p>
<p>I saw some messages about how to get the <strong>chat codes</strong> of the items we get from the API, so I thought a collection of snippets in multiple languages would be nice.</p>
<p>I’ll start with JavaScript and PHP, feel free to adapt it in other languages if you can.</p>
<p>As pointed out by zeeZ.5713, the following functions are designed for the <strong>item_id</strong> to be lower or equal than <strong>65535</strong> (or 65536, it depends on the first ID).</p>
<p><em>So if you know how, please improve the existing functions!</em></p>
<ul>
	<li><a href="http://paste.awesom.eu/DVw">JavaScript</a> (by <a href="http://www.reddit.com/r/Guildwars2/comments/zy8gb/how_to_preview_any_item_in_the_trade_post/c68vvxi">OriginalLuCHEF</a> from reddit)</li>
	<li><a href="http://paste.awesom.eu/Vmh">PHP</a></li>
	<li><a href="http://paste.awesom.eu/99X">Python</a> (by zeeZ.5713)</li>
</ul></p>

<h2 id="">zeeZ.5713:</h2>
<p class="post-meta">
    <time datetime="2013-05-25T10:39:47+00:00">
        25 May 2013
    </time>
</p>
<p>
<p>Python?</p>
<pre><code>from base64 import b64encode
def genItemChatCode(item_id):
    return '[&amp;' + b64encode('\x02\x01' + chr(item_id%256) + chr(item_id/256) + '\x00\x00') + ']'</code>

</pre>
<p>There might be a better approach to this, though :P Also what happens once IDs exceed 65535?</p></p>

<h2 id="">Yoone.9461:</h2>
<p class="post-meta">
    <time datetime="2013-05-25T10:57:06+00:00">
        25 May 2013
    </time>
</p>
<p>
<p>Thank you, I added it.</p>
<blockquote><div class="citey"><cite title="Posted on May 25 2013 10:39AM"><a href="/forum/community/api/How-to-Get-chat-code-with-item-ID/2089524">zeeZ.5713:</a></cite></div><div class="quotey"><p>There might be a better approach to this, though :P Also what happens once IDs exceed 65535?</p></div></blockquote>
<p>That’s why I said: “You also can improve the existing functions!”<img src="/include/images/smilies/smile.png"></p>
<p>I don’t really know what to do in that case.</p>
<p><strong>Edit:</strong> first post updated with links to external pastes (for a more readable message).</p></p>

<h2 id="">Dr Ishmael.9685:</h2>
<p class="post-meta">
    <time datetime="2013-05-25T22:15:24+00:00">
        25 May 2013
    </time>
</p>
<p>
<p>Here’s some VBA I wrote for Excel.  The Base64 module is from <a href="http://www.source-code.biz/">http://www.source-code.biz/</a> , but it expected all input to be ASCII, so I had to modify it to accept integer/byte-array inputs.</p>
<ul>
	<li>Base64Coder.bas: <a href="https://drive.google.com/file/d/0B5NobLNMdY89bElkRE9yRzRPWW8/edit?usp=sharing">https://drive.google.com/file/d/0B5NobLNMdY89bElkRE9yRzRPWW8/edit?usp=sharing</a></li>
	<li>GWID.bas: <a href="https://drive.google.com/file/d/0B5NobLNMdY89U1hTRVl5QWlWWm8/edit?usp=sharing">https://drive.google.com/file/d/0B5NobLNMdY89U1hTRVl5QWlWWm8/edit?usp=sharing</a></li>
</ul>
<p>Usage:</p>
<p>=EncodeGWID(12345)</p>
<p>=DecodeGWID(“[&amp;AGXXXX]”)</p></p>

<h2 id="">Leylin.3901:</h2>
<p class="post-meta">
    <time datetime="2014-07-13T14:17:48+00:00">
        13 Jul 2014
    </time>
</p>
<p>
<p>Hello there,</p>
<p>I don’t know if it is okay to revive this long dead thread. But the thing that you were afraid about happened: There are Item ID’s higher than 65535.</p>
<p>I used the python code snippet from zeeZ.5713 and modified it to fit into my environment:</p>
<p>def genItemChatCode(item_id):<br>
    a = b’\x02\x01’ + bytes([item_id % 256]) + bytes([int(item_id / 256)]) + b’\x00\x00’<br>
    return ‘[&amp;’ + b64encode(a).decode(encoding=“UTF-8”) + ‘]’</p>
<p>It was working really well – until I reached “Item: 65536	Ascalonian Elementalist Loot Box”.</p>
<p>After a bit of searching I stumbled across a little python gem from “Guest”:<br>
<a href="http://pastebin.com/Nkw5iZGv">http://pastebin.com/Nkw5iZGv</a></p>
<p>I modified it and used it with Python 3.3.2 and Django 1.6 as a template filter.</p>
<p>@register.filter<br>
def genItemChatCode(item_id):<br>
    – - hexa = b’\x02\x01’<br>
    – - for i in range(4):<br>
      – - – - hexa += bytes([item_id % 256])<br>
       – - – - item_id //= 256<br>
    – - return ‘[&amp;’ + b64encode(hexa).decode(encoding=“UTF-8”) + ‘]’</p>
<p>I hope this helps<img src="/include/images/smilies/smile.png"></p></p>

<h2 id="">AysonCurrax.3254:</h2>
<p class="post-meta">
    <time datetime="2014-07-14T11:24:12+00:00">
        14 Jul 2014
    </time>
</p>
<p>
<p>I too, noticed that exceeding 65535 ids borked up my previous code where only the 3rd and 4th byte were depending on the item id. The first byte indicates whether it is an item, skin etc. the second byte, atleast for items, indicates the amount of items (which is why its normally set to 1). the last 4 bytes consist of the item id in little endian order.<br>
This is how i did it in Java :</p>
<p>private String encodeBase64(int itemId) {<br>
		byte[] temp = ByteBuffer.allocate(4).order(ByteOrder.LITTLE_ENDIAN).putInt(itemId).array();<br>
		StringBuilder result = new StringBuilder();<br>
		result.append(“[&amp;”);<br>
		byte[ ] bytes = new byte[ 6 ];<br>
		bytes[ 0 ] = 0×02;<br>
		bytes[ 1 ] = 0×01;<br>
		bytes[ 2 ] = temp[ 0 ];<br>
		bytes[ 3 ] = temp[ 1 ];<br>
		bytes[ 4 ] = temp[ 2 ];<br>
		bytes[ 5 ] = temp[ 3 ];<br>
		result.append(Base64.encodeBase64String(bytes));<br>
		result.append(“]”);<br>
		return result.toString();<br>
	}</p>
<p>i noticed because i wanted to test my chat code for light of dwayna (infused) which resulted in some blue item. the cause was the fact that all chat codes with an item id below 65535 would end in AA, but since this one is above that limit, it should have ended in EA. I hope this helped.</p></p>

<h2 id="">smiley.1438:</h2>
<p class="post-meta">
    <time datetime="2015-02-10T19:51:15+00:00">
        10 Feb 2015
    </time>
</p>
<p>
<p>So here’s a snippet for PHP which works with IDs &gt; 16 bit:</p>
<p><a href="https://gist.github.com/codemasher/47dea40f70f990480c5b">https://gist.github.com/codemasher/47dea40f70f990480c5b</a></p></p>


  </div>

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">GW2 Developers</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              GW2 Developers
            
            </li>
            
            <li><a href="mailto:gw2developers@darthmaim.de">gw2developers@darthmaim.de</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/gw2developers"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">gw2developers</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/gw2api"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">gw2api</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Learn how to use the GW2 API.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
