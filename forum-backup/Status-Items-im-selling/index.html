<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Status: Items im selling</title>
  <meta name="description" content="Learn how to use the GW2 API.">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="/forum-backup/Status-Items-im-selling/">
  <link rel="alternate" type="application/rss+xml" title="GW2 Developers" href="/feed.xml">
  
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106748097-1', 'auto');
  ga('send', 'pageview');

</script>
  

  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/"><img src="/assets/images/logo.svg"></a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/forum-backup/">Forum Backup</a>
            
          
            
            
            <a class="page-link" href="/guides/">Guides</a>
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Status: Items im selling</h1>
  </header>

  <div class="post-content">
    


<p class="post-meta">
    Original Url: http://forum-en.guildwars2.com/forum/community/api/Status-Items-im-selling
</p>



<h2 id="">Romek.4201:</h2>
<p class="post-meta">
    <time datetime="2014-01-28T11:48:27+00:00">
        28 Jan 2014
    </time>
</p>
<p>
<p>Is it possible to get the Status from my Items im actual selling in TP?</p>
<p>i mean is it possible to have a list from all my items in TP?</p>
<p>when yes, how can i get this data in an excel sheet?</p></p>

<h2 id="">DarkSpirit.7046:</h2>
<p class="post-meta">
    <time datetime="2014-01-28T13:49:55+00:00">
        28 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 28 2014 11:48AM"><a href="/forum/community/api/Status-Items-im-selling/3560554">Romek.4201:</a></cite></div><div class="quotey"><p>Is it possible to get the Status from my Items im actual selling in TP?</p>
<p>i mean is it possible to have a list from all my items in TP?</p>
<p>when yes, how can i get this data in an excel sheet?</p></div></blockquote>
<p>The answer is yes, but I am not an excel expert so I don’t know how to get this data into excel. <img src="/include/images/smilies/smile.png"></p>
<p>To do this, you need to acquire your guild wars 2 client game session key.  Then set it in your cookie when communicating with the TP server.</p>
<p>To view the number of items in your current sell list:</p>
<p><a href="https://tradingpost-live.ncplatform.net/ws/me.json?time=now&type=sell&charid">https://tradingpost-live.ncplatform.net/ws/me.json?time=now&amp;type=sell&amp;charid</a>=&lt;your character id guid&gt;&amp;offset=1&amp;count=&lt;how many records you want returned&gt;</p>
<p>You can see your character’s id and your game session key through fiddler.  You need to keep your GW2 login session running in the background in order for the session key to not expire.</p></p>

<h2 id="">Romek.4201:</h2>
<p class="post-meta">
    <time datetime="2014-01-28T16:35:32+00:00">
        28 Jan 2014
    </time>
</p>
<p>
<p>oh thx darkspirit and very nice it is possible<br>
but i dont understand anything^^</p>
<p>can you or someone guide me how i can get the “Items im Selling” as a csv file? (maby with a step by step for idiots or so<img src="/include/images/smilies/smile.png"> )</p>
<p>thx<img src="/include/images/smilies/smile.png"></p></p>

<h2 id="">smiley.1438:</h2>
<p class="post-meta">
    <time datetime="2014-01-28T16:46:05+00:00">
        28 Jan 2014
    </time>
</p>
<p>
<p>this? <a href="/forum-backup/Guide-to-the-Black-Lion-Trading-Co-API">https://forum-en.guildwars2.com/forum/community/api/Guide-to-the-Black-Lion-Trading-Co-API/</a></p>
<p>(some programming skills may be required…)</p></p>

<h2 id="">Ryan.9387:</h2>
<p class="post-meta">
    <time datetime="2014-01-28T17:21:02+00:00">
        28 Jan 2014
    </time>
</p>
<p>
<p>Json is impossible to manage in excel. I think your best option is to have some sort of a program that pulls API data, parses it into csv, and sends it to a text file excel reads.</p></p>

<h2 id="">multivira.7925:</h2>
<p class="post-meta">
    <time datetime="2014-01-29T08:48:30+00:00">
        29 Jan 2014
    </time>
</p>
<p>
<p>Aren’t there some modules lying about online to parse json in vba (something like <a href="https://code.google.com/p/vba-json/">this</a> , haven’t personally checked it)? You’d think it would be a common enough problem. In the end you can make anything in VBA that you can make in any other programming language, so it should be entirely possible to do it in excel.</p>
<p>As with making any custom tool, it’ll require some programming knowledge though.</p></p>

<h2 id="">Healix.5819:</h2>
<p class="post-meta">
    <time datetime="2014-01-29T11:08:05+00:00">
        29 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 28 2014 04:35PM"><a href="/forum/community/api/Status-Items-im-selling/3561783">Romek.4201:</a></cite></div><div class="quotey"><p>can you or someone guide me how i can get the “Items im Selling” as a csv file?</p></div></blockquote>
<p>Without using any additional programs, this is how you can pull the listings in a comma separated format:</p>
<p>I’m assuming you’re using <strong>Windows</strong> with <strong>IE7+, Firefox or Chrome</strong>.</p>
<p>First, you need to know your session key. Start GW2 and open the trading post. Press <strong>CTRL+SHIFT+ESC</strong> to bring up the <strong>Window’s Task Manager</strong>. Under <strong>Processes</strong> look for a process named <strong>awesomium_process.exe</strong>. Note that the trading post window must be open in-game. Right click awesomium_process.exe and select <strong>Open File Location</strong>. This should bring up the <strong>gw2cache</strong> folder that stores the trading post’s cache files. In the folder should be a <strong>data</strong> folder and within that folder should be a <strong>Cookies</strong> file.</p>
<p>Open the Cookies files using <strong>notepad</strong>. Search for the text <strong>tradingpost-live.ncplatform.nets</strong>. Your session key is the series of character between the <strong>s</strong> in <em>nets</em> and the <strong>/</strong>. Copy it. It should be in the format <em>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</em>. Note that there may be more than 1 unique session key in the file for the same domain. If this happens, you’ll have to use trial and error or close GW2, delete the Cookies file and start again.</p>
<p>In IE7+, Firefox or Chrome, open the following url:</p>
<blockquote><div class="quotey"><pre><code>https://tradingpost-live.ncplatform.net/ws/me.json?time=now&amp;type=sell&amp;offset=1&amp;count=100</code></pre></div></blockquote>
<p>You can replace the <em>&amp;count=100</em> with however many listings you want to pull. The page should display the text <em>ERROR: Invalid authorization</em>.</p>
<p>In your browser, press <strong>F12</strong> to open the <strong>developer tools</strong>. Look for the <strong>Console</strong> tab. Under the console you should see an area to input text, noted by the <strong>&gt;</strong>. To run a script in the console, you either need to press <em>enter</em> or click a run/play button.</p>
<p>The first code you want to run is to set your cookie. Take your session key from before and replace <em>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</em> in the following code with your key:</p>
<blockquote><div class="quotey"><pre><code>document.cookie = "s=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX";</code></pre></div></blockquote>
<p>Run the code and refresh the page. If using IE, you’ll need to close the developer tools and reopen it with F12 once the page has been refreshed. The page should now display a bunch of text instead of invalid authorization.</p>
<p>Next, run the following code to format the JSON into CSV:</p>
<blockquote><div class="quotey"><pre><code>var o = JSON.parse(document.body.childNodes[0].innerHTML || document.body.innerHTML)
var s = "#item_id, name, rarity, quantity, unit price, listings (buy), offering price, "
+ "listings (sell), asking price, date posted&lt;br/&gt;";
for (var i in o.listings) { var l = o.listings[i]; s += l.data_id + ", \"" + l.name + "\", " + l.rarity_word + ", " + l.quantity 
+ ", " + l.unit_price + ", " + l.buy_count + ", " + l.buy_price + ", " + l.sell_count + ", " + l.sell_price + ", " 
+ l.created + "&lt;br/&gt;" }
document.body.innerHTML = s;</code></pre></div></blockquote></p>

<h2 id="">Ryan.9387:</h2>
<p class="post-meta">
    <time datetime="2014-01-30T00:11:23+00:00">
        30 Jan 2014
    </time>
</p>
<p>
<p>I think the OP wants this to be somewhat automated, rather than long and complex.</p></p>

<h2 id="">Romek.4201:</h2>
<p class="post-meta">
    <time datetime="2014-02-01T10:56:06+00:00">
        01 Feb 2014
    </time>
</p>
<p>
<p>thx Healix.5819 for this guide – i will work on it<img src="/include/images/smilies/smile.png"></p>
<p>a Question – what language i should look into to automate this?</p>
<p>can it be done with java? Or Visual Basic?<br>
Or something like spidy but offline – can this be done with java or what would be better to learn?^^</p></p>

<h2 id="">smiley.1438:</h2>
<p class="post-meta">
    <time datetime="2014-02-01T15:10:17+00:00">
        01 Feb 2014
    </time>
</p>
<p>
<p>PHP is easy to learn, very well documented and doesn’t require any compiling and stuff – just a local webserver (e.g. XAMPP) and web browser or the command line<img src="/include/images/smilies/wink.png"></p></p>

<h2 id="">Healix.5819:</h2>
<p class="post-meta">
    <time datetime="2014-02-01T15:16:22+00:00">
        01 Feb 2014
    </time>
</p>
<p>
<p>Any language that is capable of reading files and network access would be capable of automating that script. Visual Basic, Java or C# could do it fairly easy. Visual Basic is more human readable, which may or may not be more confusing depending on if you’d rather see “If x Then y End If” or “if (x) { y }”. Java, C# and JavaScript all use a similar style, with C# being easier to make Windows applications, whereas Java is easier to make cross-platform applications.</p>
<p>GW2Spidy uses PHP scripts which requires running a PHP capable web server. XAMP is an easy to setup all-in-one server if you wanted that. PHP’s style is similar to C++, which is a little more complex than Java/C#/JavaScript.</p>
<p>All languages use relatively the same style, so once you’ve learned one you should be able to figure out the others. Choosing which one you want to start with is more up to choosing what you want to create (websites, windows or cross-platform apps).</p></p>


  </div>

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">GW2 Developers</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              GW2 Developers
            
            </li>
            
            <li><a href="mailto:gw2developers@darthmaim.de">gw2developers@darthmaim.de</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/gw2developers"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">gw2developers</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/gw2api"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">gw2api</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Learn how to use the GW2 API.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
