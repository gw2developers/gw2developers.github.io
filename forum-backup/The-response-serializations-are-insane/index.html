<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>The response serializations are insane</title>
  <meta name="description" content="Learn how to use the GW2 API.">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="/forum-backup/The-response-serializations-are-insane/">
  <link rel="alternate" type="application/rss+xml" title="GW2 Developers" href="/feed.xml">
  
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106748097-1', 'auto');
  ga('send', 'pageview');

</script>
  

  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/"><img src="/assets/images/logo.svg"></a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/forum-backup/">Forum Backup</a>
            
          
            
            
            <a class="page-link" href="/guides/">Guides</a>
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">The response serializations are insane</h1>
  </header>

  <div class="post-content">
    


<p class="post-meta">
    Original Url: http://forum-en.guildwars2.com/forum/community/api/The-response-serializations-are-insane
</p>



<h2 id="">Morhyn.8032:</h2>
<p class="post-meta">
    <time datetime="2014-01-15T17:56:04+00:00">
        15 Jan 2014
    </time>
</p>
<p>
<p>Why do you insist on including the method name in the response?  As an example, if we query /v1/continents.json we <em>know</em> we’re getting back a list of continents. We don’t need to be told again. The serialization would be much simpler like so:</p>
<pre><code>
{
  "1": {
    "name": "Tyria",
    "continent_dims": [ 32768, 32768 ],
    "min_zoom": 0,
    "max_zoom": 7,
    "floors": [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
      18, 19, 30, -2, -3, -4, -5, -6, -7, -8, -10, -11, -15, -16, -17, 38,
      20, 21, 22, 23, 24, 25, 26, 27, 34, 36, 37 ]
  },
    "2": {
    "name": "Mists",
    "continent_dims": [ 16384, 16384 ],
    "min_zoom": 0,
    "max_zoom": 6,
    "floors": [ 1, 3, 5, 6, 7, 8, 9, 10, 13, 14, 18, 19, 21, 22, 23, 24, 25,
      26, -27, -28, -29, -30, -31, -32, -33, 27 ]
  }
}
</code></pre>
<p>In fact, I’d much rather see:</p>
<pre><code>
[
  {
    "id": 1,
    "name": "Tyria",
    "continent_dims": [ 32768, 32768 ],
    "min_zoom": 0,
    "max_zoom": 7,
    "floors": [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,
      18, 19, 30, -2, -3, -4, -5, -6, -7, -8, -10, -11, -15, -16, -17, 38,
      20, 21, 22, 23, 24, 25, 26, 27, 34, 36, 37 ]
  },
  {
    "id": 2,
    "name": "Mists",
    "continent_dims": [ 16384, 16384 ],
    "min_zoom": 0,
    "max_zoom": 6,
    "floors": [ 1, 3, 5, 6, 7, 8, 9, 10, 13, 14, 18, 19, 21, 22, 23, 24, 25,
      26, -27, -28, -29, -30, -31, -32, -33, 27 ]
  }
]
</code></pre></p>

<h2 id="">Ryan.9387:</h2>
<p class="post-meta">
    <time datetime="2014-01-15T20:36:32+00:00">
        15 Jan 2014
    </time>
</p>
<p>
<p>The brackets would be easier, but I don’t have any trouble just using json parse to make it into a dictionary.</p>
<p>The headers are useful in their own way. Maybe not for your call. But some provide totals and such. (If I’m interpreting your complaint correctly.)</p></p>

<h2 id="">Morhyn.8032:</h2>
<p class="post-meta">
    <time datetime="2014-01-15T21:52:17+00:00">
        15 Jan 2014
    </time>
</p>
<p>
<p>Where do the “headers” provide a total?</p></p>

<h2 id="">Ryan.9387:</h2>
<p class="post-meta">
    <time datetime="2014-01-16T00:54:04+00:00">
        16 Jan 2014
    </time>
</p>
<p>
<p>BLTP is the first that comes to mind. You can search with count=0 and get a total count returned in a part of the json.</p></p>

<h2 id="">Morhyn.8032:</h2>
<p class="post-meta">
    <time datetime="2014-01-16T01:18:33+00:00">
        16 Jan 2014
    </time>
</p>
<p>
<p>I’m sorry, I don’t know what “BLTP” is an acronym for. I don’t see anything in the list that it could be — <a href="http://wiki.guildwars2.com/wiki/API:1">http://wiki.guildwars2.com/wiki/API:1</a></p></p>

<h2 id="">smiley.1438:</h2>
<p class="post-meta">
    <time datetime="2014-01-16T02:01:52+00:00">
        16 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 16 2014 01:18AM"><a href="/forum/community/api/The-response-serializations-are-insane/3501996">Morhyn.8032:</a></cite></div><div class="quotey"><p>I’m sorry, I don’t know what “BLTP” is an acronym for. I don’t see anything in the list that it could be — <a href="http://wiki.guildwars2.com/wiki/API:1">http://wiki.guildwars2.com/wiki/API:1</a></p></div></blockquote>
<p>BLTP – Black Lion Trading Post (my guess)</p></p>

<h2 id="">DarkSpirit.7046:</h2>
<p class="post-meta">
    <time datetime="2014-01-16T03:45:12+00:00">
        16 Jan 2014
    </time>
</p>
<p>
<p>Let me try to answer this in the context of C#.  For the first case, it is natural to deserialize to a Dictionary and for the second, a List.</p>
<p>In terms of lookup times, the Dictionary is usually faster than the List, unless you have only 3 items or fewer.</p>
<p><a href="http://www.dotnetperls.com/dictionary-time">http://www.dotnetperls.com/dictionary-time</a></p></p>

<h2 id="">Morhyn.8032:</h2>
<p class="post-meta">
    <time datetime="2014-01-16T14:07:21+00:00">
        16 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 16 2014 03:45AM"><a href="/forum/community/api/The-response-serializations-are-insane/3502406">DarkSpirit.7046:</a></cite></div><div class="quotey"><p>Let me try to answer this in the context of C#.  For the first case, it is natural to deserialize to a Dictionary and for the second, a List.</p>
<p>In terms of lookup times, the Dictionary is usually faster than the List, unless you have only 3 items or fewer.</p>
<p><a href="http://www.dotnetperls.com/dictionary-time">http://www.dotnetperls.com/dictionary-time</a></p></div></blockquote>
<p>Yes, if you’re deserializing my suggested “fixed” serializations. With the actual API result you either:</p>
<ul>
	<li>deserialize to a dictionary with one key who’s value is the real result</li>
	<li>write a custom deserializer to ignore the useless outer key</li>
</ul>
<p>I don’t see the point in either case. Not when the API could simply return the real result very easily.</p></p>

<h2 id="">Morhyn.8032:</h2>
<p class="post-meta">
    <time datetime="2014-01-16T14:08:16+00:00">
        16 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 16 2014 02:01AM"><a href="/forum/community/api/The-response-serializations-are-insane/3502130">smiley.1438:</a></cite></div><div class="quotey"><blockquote><div class="citey"><cite title="Posted on January 16 2014 01:18AM"><a href="/forum/community/api/The-response-serializations-are-insane/3501996">Morhyn.8032:</a></cite></div><div class="quotey"><p>I’m sorry, I don’t know what “BLTP” is an acronym for. I don’t see anything in the list that it could be — <a href="http://wiki.guildwars2.com/wiki/API:1">http://wiki.guildwars2.com/wiki/API:1</a></p></div></blockquote>
<p>BLTP – Black Lion Trading Post (my guess)</p></div></blockquote>
<p>Unless I’ve missed it, that isn’t a part of the official public API.</p></p>

<h2 id="">smiley.1438:</h2>
<p class="post-meta">
    <time datetime="2014-01-16T14:11:53+00:00">
        16 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 16 2014 02:08PM"><a href="/forum/community/api/The-response-serializations-are-insane/3503959">Morhyn.8032:</a></cite></div><div class="quotey"><blockquote><div class="citey"><cite title="Posted on January 16 2014 02:01AM"><a href="/forum/community/api/The-response-serializations-are-insane/3502130">smiley.1438:</a></cite></div><div class="quotey"><blockquote><div class="citey"><cite title="Posted on January 16 2014 01:18AM"><a href="/forum/community/api/The-response-serializations-are-insane/3501996">Morhyn.8032:</a></cite></div><div class="quotey"><p>I’m sorry, I don’t know what “BLTP” is an acronym for. I don’t see anything in the list that it could be — <a href="http://wiki.guildwars2.com/wiki/API:1">http://wiki.guildwars2.com/wiki/API:1</a></p></div></blockquote>
<p>BLTP – Black Lion Trading Post (my guess)</p></div></blockquote>
<p>Unless I’ve missed it, that isn’t a part of the official public API.</p></div></blockquote>
<p>It isn’t – but as you can read in this subforum, it’s happily used…</p></p>

<h2 id="">Morhyn.8032:</h2>
<p class="post-meta">
    <time datetime="2014-01-16T14:34:49+00:00">
        16 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 16 2014 02:11PM"><a href="/forum/community/api/The-response-serializations-are-insane/3503973">smiley.1438:</a></cite></div><div class="quotey"><blockquote><div class="citey"><cite title="Posted on January 16 2014 02:08PM"><a href="/forum/community/api/The-response-serializations-are-insane/3503959">Morhyn.8032:</a></cite></div><div class="quotey"><blockquote><div class="citey"><cite title="Posted on January 16 2014 02:01AM"><a href="/forum/community/api/The-response-serializations-are-insane/3502130">smiley.1438:</a></cite></div><div class="quotey"><blockquote><div class="citey"><cite title="Posted on January 16 2014 01:18AM"><a href="/forum/community/api/The-response-serializations-are-insane/3501996">Morhyn.8032:</a></cite></div><div class="quotey"><p>I’m sorry, I don’t know what “BLTP” is an acronym for. I don’t see anything in the list that it could be — <a href="http://wiki.guildwars2.com/wiki/API:1">http://wiki.guildwars2.com/wiki/API:1</a></p></div></blockquote>
<p>BLTP – Black Lion Trading Post (my guess)</p></div></blockquote>
<p>Unless I’ve missed it, that isn’t a part of the official public API.</p></div></blockquote>
<p>It isn’t – but as you can read in this subforum, it’s happily used…</p></div></blockquote>
<p>Okay, well let me clarify: I’m only concerned with what is published as “officially public.” I haven’t seen anything in that API where dictionary keys are used as a total for a search result. What I have repeatedly seen is the name of the API method being returned as an initial dictionary key with no explained reason. Which, as I mentioned in a previous reply, is annoying during deserialization due to having to filter it out or write weird objects to map the result to.</p></p>

<h2 id="">smiley.1438:</h2>
<p class="post-meta">
    <time datetime="2014-01-16T14:39:45+00:00">
        16 Jan 2014
    </time>
</p>
<p>
<p>Just btw. – We’re talking about <a href="http://json.org/">JSON</a> here. We’re talking about object identifiers and not about methods. Within it’s intended target languages (JS/web), these object identifiers are perfectly fine and useful – e.g. for jQuery/prototype’s each() methods where they are passed as index argument.</p></p>

<h2 id="">Morhyn.8032:</h2>
<p class="post-meta">
    <time datetime="2014-01-16T15:07:24+00:00">
        16 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 16 2014 02:39PM"><a href="/forum/community/api/The-response-serializations-are-insane/3504057">smiley.1438:</a></cite></div><div class="quotey"><p>Just btw. – We’re talking about <a href="http://json.org/">JSON</a> here. We’re talking about object identifiers and not about methods. Within it’s intended target languages (JS/web), these object identifiers are perfectly fine and useful – e.g. for jQuery/prototype’s each() methods where they are passed as index argument.</p></div></blockquote>
<p>In the example that starts this thread, the method is /v1/continents.json. The result includes the method name, “continents”, as a key in the result.</p>
<p>JSON is merely a simple representation of the data. It does not have a target language (despite being valid JavaScript). From <a href="http://www.ietf.org/rfc/rfc4627.txt">http://www.ietf.org/rfc/rfc4627.txt</a> (emphasis added) —</p>
<blockquote><div class="quotey"><p>JavaScript Object Notation (JSON) is a lightweight, text-based,<br>
   <strong>language-independent</strong> data interchange format.  It was derived from<br>
   the ECMAScript Programming Language Standard.  JSON defines a small<br>
   set of formatting rules for the portable representation of structured<br>
   data.</p></div></blockquote>
<p>But let’s look at a concrete example using JavaScript — <a href="http://jsfiddle.net/jsumners/vH5W8/">http://jsfiddle.net/jsumners/vH5W8/</a>. Notice that even in JavaScript the true result of the API method call has to be dereferenced from the included key. Thus, you can’t simply loop over what is returned from the API call.</p>
<p>Yes, in JavaScript this isn’t so much of a problem. You can mostly just shrug it off and move on. But when you start importing this data into a language with proper types (e.g. Java in my case or C# in a previous poster’s), it adds unnecessary complications. The API could be simpler and better if it just didn’t include the method name as a key.</p></p>

<h2 id="">Heimdall.4510:</h2>
<p class="post-meta">
    <time datetime="2014-01-16T15:39:17+00:00">
        16 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite>Morhyn.8032</cite></div><div class="quotey"><p>Yes, in JavaScript this isn’t so much of a problem. You can mostly just shrug it off and move on. But when you start importing this data into a language with proper types (e.g. Java in my case or C# in a previous poster’s), it adds unnecessary complications. The API could be simpler and better if it just didn’t include the method name as a key.</p></div></blockquote>
<p>I really don’t get your problem with that, just parse the JSON-Object and put the result into the format you need.<br>
I personally would also prefer raw binary data which could be simply put into a c struct but that’s not possible in all languages. I guess that’s why the GW2-Team decided to put the queryresults into a format which can be handled by all languages<img src="/include/images/smilies/wink.png"></p></p>

<h2 id="">Ryan.9387:</h2>
<p class="post-meta">
    <time datetime="2014-01-16T18:43:04+00:00">
        16 Jan 2014
    </time>
</p>
<p>
<p>I’ve never had any issue though. I just parse it in python into a giant dictionary and if I don’t want a key I just remove it or create a new dictionary with the values I want</p></p>

<h2 id="">Killer Rhino.6794:</h2>
<p class="post-meta">
    <time datetime="2014-01-17T00:53:48+00:00">
        17 Jan 2014
    </time>
</p>
<p>
<p>110% agree with the OP. The response structure is certainly kludgy, and I’m surprised that this hasn’t been more of a contentious topic here.</p>
<p>I suspect that most people are just <em>used</em> to it at this point. The good news is that there’s so few updates to the APIs that you’ll have <strong>plenty</strong> of time to work on hacks which can compensate.</p>
<p><em>OH SNAP!</em></p></p>

<h2 id="">Morhyn.8032:</h2>
<p class="post-meta">
    <time datetime="2014-01-17T03:57:30+00:00">
        17 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 17 2014 12:53AM"><a href="/forum/community/api/The-response-serializations-are-insane/3506689">Killer Rhino.6794:</a></cite></div><div class="quotey"><p>110% agree with the OP. The response structure is certainly kludgy, and I’m surprised that this hasn’t been more of a contentious topic here.</p>
<p>I suspect that most people are just <em>used</em> to it at this point. The good news is that there’s so few updates to the APIs that you’ll have <strong>plenty</strong> of time to work on hacks which can compensate.</p>
<p><em>OH SNAP!</em></p></div></blockquote>
<p>I was beginning to think no one else understood. Thank you for chiming in.</p></p>

<h2 id="">DarkSpirit.7046:</h2>
<p class="post-meta">
    <time datetime="2014-01-17T14:53:52+00:00">
        17 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 16 2014 02:07PM"><a href="/forum/community/api/The-response-serializations-are-insane/3503955">Morhyn.8032:</a></cite></div><div class="quotey"><blockquote><div class="citey"><cite title="Posted on January 16 2014 03:45AM"><a href="/forum/community/api/The-response-serializations-are-insane/3502406">DarkSpirit.7046:</a></cite></div><div class="quotey"><p>Let me try to answer this in the context of C#.  For the first case, it is natural to deserialize to a Dictionary and for the second, a List.</p>
<p>In terms of lookup times, the Dictionary is usually faster than the List, unless you have only 3 items or fewer.</p>
<p><a href="http://www.dotnetperls.com/dictionary-time">http://www.dotnetperls.com/dictionary-time</a></p></div></blockquote>
<p>Yes, if you’re deserializing my suggested “fixed” serializations. With the actual API result you either:</p>
<ul>
	<li>deserialize to a dictionary with one key who’s value is the real result</li>
	<li>write a custom deserializer to ignore the useless outer key</li>
</ul>
<p>I don’t see the point in either case. Not when the API could simply return the real result very easily.</p></div></blockquote>
<p>If you are deserializing it to a dictionary then you are deserializing more than just one record.  Furthermore, the API goes through the web and it is therefore very slow, so unless the record changes often, you want to download/cache the records into say, a JSON file, and read them into a dictionary to increase performance.</p></p>

<h2 id="">StevenL.3761:</h2>
<p class="post-meta">
    <time datetime="2014-01-18T00:15:04+00:00">
        18 Jan 2014
    </time>
</p>
<p>
<p>I find it actually quite useful to have the results collection be a named property of the root object. At least, that way you can refer to it by name.</p>
<p>It’s just annoying that the API is so inconsistent. For example: the “continents.json” API has this behavior whereas the “event_names.json” API doesn’t. As @Rhino suggests, you gotta write a different hack for each endpoint. It would be nice being able to reuse the same sloppy code for everything.</p></p>

<h2 id="">Kegsay.7068:</h2>
<p class="post-meta">
    <time datetime="2014-01-18T00:53:25+00:00">
        18 Jan 2014
    </time>
</p>
<p>
<p>Yeah, it is pretty tedious having to go through and deal with some interesting JSON structures from the various endpoints we can hit. That being said, it’s also not difficult to just parse it out.</p>
<p>At this point, it would be far more damaging to change the spec and break everyone’s stuff, so I would prefer it if no changes were made. However, presenting a consistent format for all new APIs going forward would be a great idea.</p></p>

<h2 id="">smiley.1438:</h2>
<p class="post-meta">
    <time datetime="2014-01-18T02:43:33+00:00">
        18 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 18 2014 12:53AM"><a href="/forum/community/api/The-response-serializations-are-insane/3511609">Kegsay.7068:</a></cite></div><div class="quotey"><p>At this point, it would be far more damaging to change the spec and break everyone’s stuff, so I would prefer it if no changes were made. However, presenting a consistent format for all new APIs going forward would be a great idea.</p></div></blockquote>
<p>I wouldn’t mind at all if it would break stuff in favour of overall consistent responses.</p>
<blockquote><div class="citey"><cite title="Posted on May 14 2013 11:01PM"><a href="/forum/community/api/API-Documentation/2028044">Cliff Spradlin</a></cite></div><div class="quotey"><p>These APIs are in beta, so don’t be surprised if the interfaces change, but we will try to warn you if we have to make any breaking changes.</p></div></blockquote></p>

<h2 id="">StevenL.3761:</h2>
<p class="post-meta">
    <time datetime="2014-01-18T12:39:59+00:00">
        18 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 18 2014 12:53AM"><a href="/forum/community/api/The-response-serializations-are-insane/3511609">Kegsay.7068:</a></cite></div><div class="quotey"><p>At this point, it would be far more damaging to change the spec and break everyone’s stuff, so I would prefer it if no changes were made. However, presenting a consistent format for all new APIs going forward would be a great idea.</p></div></blockquote>
<p>The best way forward (imo) would be to go ahead and make the breaking changes, but make the improved APIs available alongside the existing APIs  as <em>v2/*.json</em>. Then when everyone has migrated, perhaps a year later, they can take the old version offline.</p></p>

<h2 id="">Kegsay.7068:</h2>
<p class="post-meta">
    <time datetime="2014-01-18T13:11:57+00:00">
        18 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 18 2014 12:39PM"><a href="/forum/community/api/The-response-serializations-are-insane/3513736">StevenL.3761:</a></cite></div><div class="quotey"><blockquote><div class="citey"><cite title="Posted on January 18 2014 12:53AM"><a href="/forum/community/api/The-response-serializations-are-insane/3511609">Kegsay.7068:</a></cite></div><div class="quotey"><p>At this point, it would be far more damaging to change the spec and break everyone’s stuff, so I would prefer it if no changes were made. However, presenting a consistent format for all new APIs going forward would be a great idea.</p></div></blockquote>
<p>The best way forward (imo) would be to go ahead and make the breaking changes, but make the improved APIs available alongside the existing APIs  as <em>v2/*.json</em>. Then when everyone has migrated, perhaps a year later, they can take the old version offline.</p></div></blockquote>
<p>I like this idea.</p></p>

<h2 id="">Morhyn.8032:</h2>
<p class="post-meta">
    <time datetime="2014-01-18T15:55:37+00:00">
        18 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 18 2014 12:39PM"><a href="/forum/community/api/The-response-serializations-are-insane/3513736">StevenL.3761:</a></cite></div><div class="quotey"><blockquote><div class="citey"><cite title="Posted on January 18 2014 12:53AM"><a href="/forum/community/api/The-response-serializations-are-insane/3511609">Kegsay.7068:</a></cite></div><div class="quotey"><p>At this point, it would be far more damaging to change the spec and break everyone’s stuff, so I would prefer it if no changes were made. However, presenting a consistent format for all new APIs going forward would be a great idea.</p></div></blockquote>
<p>The best way forward (imo) would be to go ahead and make the breaking changes, but make the improved APIs available alongside the existing APIs  as <em>v2/*.json</em>. Then when everyone has migrated, perhaps a year later, they can take the old version offline.</p></div></blockquote>
<p>Considering the age of v1, I agree. The current version has been around long enough that it doesn’t matter if it was put out under the caveat that it is “a beta.” There are many people using it as it is, and they don’t expect drastic changes due to the long times between updates.</p>
<p>I didn’t make the post expecting ANet to turn around and “fix” the v1 methods. But I do hope they take it under advisement for v2.</p></p>

<h2 id="">cvpcs.5914:</h2>
<p class="post-meta">
    <time datetime="2014-01-18T16:33:18+00:00">
        18 Jan 2014
    </time>
</p>
<p>
<p>It doesn’t seem too <em>hacky</em> to me to handle this (at least in C#). I personally use the <a href="http://restsharp.org">RestSharp</a> library to handle REST requests and the corresponding JSON deserialization. From there I just need to pass in the type that I’m deserializing to for REST to do its thing. For example, I have a basic <strong>Request</strong> class that looks like so:</p>
<div class="spoiler_container"><div class="spoileroncontainer"><button type="button" class="button spoileron" title="Click to show the spoiler.">Show Spoiler</button></div><div class="spoiler"><div class="spoileroffcontainer"><button type="button" class="button spoileroff" title="Click to hide the spoiler.">hide spoiler</button><br></div><div class="spoilertext"><pre><code>using System;
using System.Collections.Generic;

using RestSharp;

namespace GuildWars2.ArenaNet.API
{
    public abstract partial class Request&lt;T&gt;
        where T : class, new()
    {
        public static int Timeout = 10000;
        public static readonly string URL = "https://api.guildwars2.com";
        public static readonly string Version = "v1";

        protected abstract string APIPath { get; }

        protected virtual Dictionary&lt;string, string&gt; APIParameters
        {
            get { return new Dictionary&lt;string, string&gt;(); }
        }

        protected virtual Method APIMethod
        {
            get { return Method.GET; }
        }

        public T Execute()
        {
            RestClient client = new RestClient();
            client.BaseUrl = URL;
            client.Timeout = Timeout;

            RestRequest request = new RestRequest();
            request.Method = APIMethod;
            request.Resource = APIPath;

            foreach (KeyValuePair&lt;string, string&gt; parameter in APIParameters)
            {
                request.AddParameter(parameter.Key, parameter.Value);
            }

            IRestResponse&lt;T&gt; response = client.Execute&lt;T&gt;(request);

            if (response.StatusCode == System.Net.HttpStatusCode.OK)
                return response.Data;
            else
                return null;
        }
    }
}</code></pre></div></div></div><p>I then have a <strong>ContinentRequest</strong> file that extends that and looks like so:</p>
<div class="spoiler_container"><div class="spoileroncontainer"><button type="button" class="button spoileron" title="Click to show the spoiler.">Show Spoiler</button></div><div class="spoiler"><div class="spoileroffcontainer"><button type="button" class="button spoileroff" title="Click to hide the spoiler.">hide spoiler</button><br></div><div class="spoilertext"><pre><code>using System;
using System.Collections.Generic;

using GuildWars2.ArenaNet.Model;

namespace GuildWars2.ArenaNet.API
{
    public class ContinentsRequest : TranslatableRequest&lt;ContinentsResponse&gt;
    {
        protected override string APIPath
        {
            get { return "/" + Version + "/continents.json"; }
        }

        public ContinentsRequest(LanguageCode lang = LanguageCode.EN)
            : base(lang)
        { }
    }
}</code></pre></div></div></div><p>So then RestSharp expects to be deserializing a type of <strong>ContinentResponse</strong>, which looks like so:</p>
<div class="spoiler_container"><div class="spoileroncontainer"><button type="button" class="button spoileron" title="Click to show the spoiler.">Show Spoiler</button></div><div class="spoiler"><div class="spoileroffcontainer"><button type="button" class="button spoileroff" title="Click to hide the spoiler.">hide spoiler</button><br></div><div class="spoilertext"><pre><code>using System;
using System.Collections.Generic;

using GuildWars2.ArenaNet.Model;

namespace GuildWars2.ArenaNet.API
{
    public class ContinentsResponse
    {
        public Dictionary&lt;string, Continent&gt; Continents { get; set; }
    }
}</code></pre></div></div></div><p>Thus RestSharp will deserialize the response as a single item which is a dictionary of <strong>Continents</strong>:</p>
<div class="spoiler_container"><div class="spoileroncontainer"><button type="button" class="button spoileron" title="Click to show the spoiler.">Show Spoiler</button></div><div class="spoiler"><div class="spoileroffcontainer"><button type="button" class="button spoileroff" title="Click to hide the spoiler.">hide spoiler</button><br></div><div class="spoilertext"><pre><code>using System;
using System.Collections.Generic;

namespace GuildWars2.ArenaNet.Model
{
    public class Continent
    {
        public string Name { get; set; }

        public List&lt;double&gt; ContinentDims { get; set; }

        public int MinZoom { get; set; }

        public int MaxZoom { get; set; }

        public List&lt;int&gt; Floors { get; set; }
    }
}</code></pre></div></div></div><p>So then to cycle through my list of <strong>Continents</strong>, I just need to call the following:</p>
<div class="spoiler_container"><div class="spoileroncontainer"><button type="button" class="button spoileron" title="Click to show the spoiler.">Show Spoiler</button></div><div class="spoiler"><div class="spoileroffcontainer"><button type="button" class="button spoileroff" title="Click to hide the spoiler.">hide spoiler</button><br></div><div class="spoilertext"><pre><code>ContinentResponse response = new ContinentRequest().Execute();

foreach (KeyValuePair&lt;string, Continent&gt; kvp in response.Continents)
{
    string cid = kvp.Key;
    Continent c = kvp.Value;

    ...
}</code></pre></div></div></div><p>I personally like having it set up this way, as all of my requests and responses have concrete types that I can modify and add extra logic to if I wish. As you can see, the fact that they nest their response dictionary inside of the Continents variable is a non-issue. If they ever got rid of that, I could just change my ContinentsResponse class to not have any variables and simply extend the Dictionary&lt;string, Continent&gt; class and update any references I’m using.</p>
<p>You can argue about refactoring code until you’re blue in the face and there will always be other people who argue that it needs to be refactored again. Your complaint was specifically around the difficulty of deserializing the response due to the desired content being nested inside of a dictionary variable in the response object, instead of the response object simply being the dictionary variable (or a list).</p>
<p>It sounds more like your deserializer doesn’t handle nested objects very well, otherwise it would be a non-issue. This is very much a solved problem at this point and there should be existing libraries that can handle this quite elegantly for you in Java.</p></p>

<h2 id="">rodadams.5963:</h2>
<p class="post-meta">
    <time datetime="2014-01-18T16:36:53+00:00">
        18 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 18 2014 12:39PM"><a href="/forum/community/api/The-response-serializations-are-insane/3513736">StevenL.3761:</a></cite></div><div class="quotey"><blockquote><div class="citey"><cite title="Posted on January 18 2014 12:53AM"><a href="/forum/community/api/The-response-serializations-are-insane/3511609">Kegsay.7068:</a></cite></div><div class="quotey"><p>At this point, it would be far more damaging to change the spec and break everyone’s stuff, so I would prefer it if no changes were made. However, presenting a consistent format for all new APIs going forward would be a great idea.</p></div></blockquote>
<p>The best way forward (imo) would be to go ahead and make the breaking changes, but make the improved APIs available alongside the existing APIs  as <em>v2/*.json</em>. Then when everyone has migrated, perhaps a year later, they can take the old version offline.</p></div></blockquote>
<p>And while we’re at it, get rid of the whole “when we refer to one thing from another, the reference is a string, but the key is an integer”, so you just have to go str→int in some pretty annoying places.</p></p>

<h2 id="">StevenL.3761:</h2>
<p class="post-meta">
    <time datetime="2014-01-18T19:39:41+00:00">
        18 Jan 2014
    </time>
</p>
<p>
<p>@cvpcs</p>
<p>We’re working on something quite similar over at the <a href="https://gw2dotnet.codeplex.com/">GW2.NET</a> project.</p>
<p>I wrote the following classes over the past couple of weeks:</p>
<ul>
	<li><a href="https://gw2dotnet.codeplex.com/SourceControl/latest#GW2.NET-Http/GW2.NET/V1/Core/ApiRequest.cs">ApiRequest : RestRequest</a></li>
	<li><a href="https://gw2dotnet.codeplex.com/SourceControl/latest#GW2.NET-Http/GW2.NET/V1/Core/Continents/ContinentsRequest.cs">ContinentsRequest : ApiRequest</a></li>
	<li><a href="https://gw2dotnet.codeplex.com/SourceControl/latest#GW2.NET-Http/GW2.NET/V1/Core/ApiResponse.cs">ApiResponse&lt;TContent&gt; : RestResponse&lt;T&gt;</a></li>
	<li><a href="https://gw2dotnet.codeplex.com/SourceControl/latest#GW2.NET-Http/GW2.NET/V1/Core/Continents/ContinentsResponse.cs">ContinentsResponse</a></li>
	<li><a href="https://gw2dotnet.codeplex.com/SourceControl/latest#GW2.NET-Http/GW2.NET/V1/Core/Continents/Continent.cs">Continent</a></li>
</ul>
<p>You seem to know your stuff. Would you be interested in becoming a contributor?</p></p>

<h2 id="">cvpcs.5914:</h2>
<p class="post-meta">
    <time datetime="2014-01-20T16:25:26+00:00">
        20 Jan 2014
    </time>
</p>
<p>
<p>@StevenL</p>
<p>I appreciate the offer but at the moment I’m too busy to do much contributing anywhere (the code above I wrote ages ago when the APIs first came out, I haven’t really touched it since).</p>
<p>That said, I’ll keep it in mind if I ever decide to delve deeper into this stuff. Perhaps if ArenaNet ever gets their OAuth and related APIs published.<img src="/include/images/smilies/colondee.png"></p></p>

<h2 id="">Lazarus.9716:</h2>
<p class="post-meta">
    <time datetime="2014-01-20T18:20:23+00:00">
        20 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 15 2014 05:56PM"><a href="/forum/community/api/The-response-serializations-are-insane/3499916">Morhyn.8032:</a></cite></div><div class="quotey"><p>Why do you insist on including the method name in the response?  As an example, if we query /v1/continents.json we <em>know</em> we’re getting back a list of continents. We don’t need to be told again.</p></div></blockquote>
<p>That would be bad API design.  Any structured information should be self-explanatory and complete so it can be included in other places (nested within another structure of information, for example).</p>
<p>Linking the format to your expectation of your top-level call makes the structure unnecessarily idiosyncratic and brittle.  It also makes you write more code when you access the same information from other areas of the API.</p></p>

<h2 id="">Morhyn.8032:</h2>
<p class="post-meta">
    <time datetime="2014-01-22T15:35:45+00:00">
        22 Jan 2014
    </time>
</p>
<p>
<blockquote><div class="citey"><cite title="Posted on January 20 2014 06:20PM"><a href="/forum/community/api/The-response-serializations-are-insane/3523019">Lazarus.9716:</a></cite></div><div class="quotey"><blockquote><div class="citey"><cite title="Posted on January 15 2014 05:56PM"><a href="/forum/community/api/The-response-serializations-are-insane/3499916">Morhyn.8032:</a></cite></div><div class="quotey"><p>Why do you insist on including the method name in the response?  As an example, if we query /v1/continents.json we <em>know</em> we’re getting back a list of continents. We don’t need to be told again.</p></div></blockquote>
<p>That would be bad API design.  Any structured information should be self-explanatory and complete so it can be included in other places (nested within another structure of information, for example).</p>
<p>Linking the format to your expectation of your top-level call makes the structure unnecessarily idiosyncratic and brittle.  It also makes you write more code when you access the same information from other areas of the API.</p></div></blockquote>
<p>Uh, no, it would be clear API design. You have requested the list of “continents” by calling the method named “continents”. Thus, you should get back a list of, you guessed it, continents. You should not be expecting anything else, thus the inclusion of the type in the response is extraneous.</p>
<p>What you do with that data once you have deserialized it is up to you. You can choose to include it in another object or simply work with it directly. But you certainly don’t need the structure to be defined by the remote method.</p></p>


  </div>

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">GW2 Developers</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              GW2 Developers
            
            </li>
            
            <li><a href="mailto:gw2developers@darthmaim.de">gw2developers@darthmaim.de</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/gw2developers"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">gw2developers</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/gw2api"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">gw2api</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Learn how to use the GW2 API.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
