{"title":"[Mumble Link Suggestions] Downed,InCombat,etc","pubDate":"2013-08-30T20:10:59.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc","comments":[{"pubDate":"2013-09-02T09:13:33.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2752053","author":"Wothor.4781","body":"\n<p>Since squads, unlike parties, do have a leader, the leader name/identifier would suffice (for me, at least).<br>\nVia character names that should total in (4+1)*40 = 200 bytes altogether isup.</p>","arenanet":false},{"pubDate":"2013-09-01T16:21:02.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2746827","author":"CyFreeze.1275","body":"\n<p>The update to the health was necessary I totally forgot about golem suits. Your max health in a golem is about 270k. So slightly more then 2^18. Good choice with the number. The rest seems to be appropriate too. Now that we have so much space left maybe some player identifiers would be nice so that we can get the whole party in there. I don’t think a squad could fit in there. But in the end that would require identifiers to be implemented first.</p>","arenanet":false},{"pubDate":"2013-08-31T20:01:18.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2741871","author":"Talus.1402","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on August 31 2013 06:44PM\"><a href=\"/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2741558\">Caldrick.6920:</a></cite></div><div class=\"quotey\"><blockquote><div class=\"citey\"><cite title=\"Posted on August 31 2013 11:11AM\"><a href=\"/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2739691\">CyFreeze.1275:</a></cite></div><div class=\"quotey\"><pre><code>\nstruct identity {\nwchar_t name;\n   int           team_color : 2;\n   int           health            : 16;\n   int           supply            : 6;\n   int           profession     : 2;\n   int           state                : 2;\n   int           commander : 1;\n   int           combat          : 1;\n   int           capturing      : 1;\n   int           instanced      : 1;\n}</code></pre>\n<p>This would result in a total of 8 bytes for the whole structure. I removed a few of the attributes as I found them to be mostly unusable like gathering (period is way to short) or dungeon which is more or less a duplicate of instanced. But of course all your fields could still be added which would add another 4 bytes due to byte alignment.</p></div></blockquote>\n<p>Agreed, this would be fine, assuming of course that the upper/lower bounds of the data are met.  For example, aren’t there more than 4 professions?</p></div></blockquote>\n<p>Team color is based on <a href=\"https://api.guildwars2.com/v1/colors.json\">dye color</a>.  Since the highest Color ID is 1242, we would require 11 bits to hold that information.  If more colors are added at a later date, might be best to round up to 2 bytes.  As of now, Red Team uses Color ID 376: Salmon and Blue Team uses Color ID 9: Blue Rose (I haven’t figured out Green Team yet).  So as far as I know, we would need 9 bits minimum to hold the Red Team Color ID.</p>\n<p>Correct about profession.  We would need at least 4 bits to hold that.</p>\n<p>Max health I saw on the forums was ~70k, so 16 bits for health sounds right.</p>\n<p>With Wothor.4781’s suggestions, the changes could look like:<br>\n</p><pre><code>struct identity {\n   wchar_t    name[ 20 ];\n   char           guild_id[ 16 ]; //guild_id looks like a 32-digit hexadecimal\n   int              team_color   : 16;\n   int              health            : 19; // EDIT: increased from 16 to 19\n   int              supply            : 6;\n   int              profession      : 8;\n   int              state               : 4;\n   int              commander  : 1;\n   int              capturing       : 1;\n   int              instanced       : 1;\n}\n</code></pre><p></p>\n<p>63 bytes total out of 512 used.  I think we might even be able to get that Squad info on here!</p>","arenanet":false},{"pubDate":"2013-08-31T19:37:57.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2741767","author":"Wothor.4781","body":"\n<p>I wouldn’t swear an oath that there’s an out of combat downed state, but yeah, sth. like that<img src=\"/include/images/smilies/smile.png\"><br>\nIf there ain’t I’d probably go<br>\n0: 00 not up, not incombat = dead<br>\n1: 01 not up, in combat = downed<br>\n2: 10 up, ooc<br>\n3: 11 up, ic<br>\njust in case, for the fun of it and have a couple of bits left for other bools.<br>\nBut after all that’s details the devs will know best what they wanna do that.</p>","arenanet":false},{"pubDate":"2013-08-31T19:13:52.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2741670","author":"Talus.1402","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on August 31 2013 08:42AM\"><a href=\"/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2739236\">Wothor.4781:</a></cite></div><div class=\"quotey\"><p>Hm, depending on what high frequency is the target, one could think about just using another transport mechanism for those, e.g. a “GWLink”, to meet the requirement of rare updates set by Mumble.<br>\nPersonally I prefer the context blob method over the JSON string.<br>\nThe last char of the character name being a null char? Putting that there should avoid messing up the mumble default gui with the data which would be nice indeed.<br>\nI guess in_combat could be added to state, saving a byte.</p></div></blockquote>\n<p>The “GWLink” would be nice, then ArenaNet wouldn’t be bound to the mumble link structure.  Depends on if they want to implement one.  Mumble link seems to take care of both cases: providing positional audio and additional info for developers.  I’m torn on the issue because it would be really nice if they made one catering to developers specifically.  Like all the extra stuff we want that is above and beyond the basic mumble requirements can be put in a GWLink memory-mapped file.</p>\n<p>The last char of the character name is expected to be null char as well as making the name 4-byte aligned.</p>\n<p>Good catch on combining in_combat and state.  An enumeration for the state could look like this:<br>\nenum PlayerState<br>\n{<br>\n     Up = 0,<br>\n     Up_Combat = 1,<br>\n     Downed = 2,<br>\n     Downed_Combat = 3,<br>\n     Defeated<br>\n};</p>","arenanet":false},{"pubDate":"2013-08-31T18:44:39.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2741558","author":"Caldrick.6920","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on August 31 2013 11:11AM\"><a href=\"/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2739691\">CyFreeze.1275:</a></cite></div><div class=\"quotey\"><pre><code>\nstruct identity {\n   wchar_t name;\n   int           team_color : 2;\n   int           health            : 16;\n   int           supply            : 6;\n   int           profession     : 2;\n   int           state                : 2;\n   int           commander : 1;\n   int           combat          : 1;\n   int           capturing      : 1;\n   int           instanced      : 1;\n}</code></pre>\n<p>This would result in a total of 8 bytes for the whole structure. I removed a few of the attributes as I found them to be mostly unusable like gathering (period is way to short) or dungeon which is more or less a duplicate of instanced. But of course all your fields could still be added which would add another 4 bytes due to byte alignment.</p></div></blockquote>\n<p>Agreed, this would be fine, assuming of course that the upper/lower bounds of the data are met.  For example, aren’t there more than 4 professions?</p>","arenanet":false},{"pubDate":"2013-08-31T18:37:38.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2741529","author":"Caldrick.6920","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on August 31 2013 08:42AM\"><a href=\"/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2739236\">Wothor.4781:</a></cite></div><div class=\"quotey\"><p>Hm, depending on what high frequency is the target, one could think about just using another transport mechanism for those, e.g. a “GWLink”, to meet the requirement of rare updates set by Mumble.<br>\nPersonally I prefer the context blob method over the JSON string.<br>\nThe last char of the character name being a null char? Putting that there should avoid messing up the mumble default gui with the data which would be nice indeed.<br>\nI guess in_combat could be added to state, saving a byte.</p></div></blockquote>\n<p>Indeed it is actually desirable to change the Identity information from a string to a binary structure.  The main reason for this being the frequency of the updates.  Currently the Identity isn’t updated regularly however, the IsCommander field might be switched often enough to warrant this information as binary so that the JSON string isn’t parsed for each access or in some update thread.</p>","arenanet":false},{"pubDate":"2013-08-31T15:49:08.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2740737","author":"Wothor.4781","body":"\n<p>Given that there’s a lot of space left, from the perspective of a Teamspeak 3 plugin dev, I actually could make most use of having the groupmembers and commander name (replacing the bool in the progress?) if in a squad.<br>\nThink whispering to your group only etc. up to (if the ids play along) the option to talk to your team in single join tournaments if a server hosts that for a region. Hu, maybe that last one ain’t a good idea hehe.</p>\n<p>From the former thread I think guild tag or name would be worth a honorable mention.</p>","arenanet":false},{"pubDate":"2013-08-31T11:11:35.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2739691","author":"CyFreeze.1275","body":"\n<pre><code>\nstruct identity {\n   wchar_t name;\n   int           team_color : 2;\n   int           health            : 16;\n   int           supply            : 6;\n   int           profession     : 2;\n   int           state                : 2;\n   int           commander : 1;\n   int           combat          : 1;\n   int           capturing      : 1;\n   int           instanced      : 1;\n}</code></pre>\n<p>This would result in a total of 8 bytes for the whole structure. I removed a few of the attributes as I found them to be mostly unsusable like gathering (period is way to short) or dungeon which is more or less a duplicate of instanced. But of course all your fields could still be added which would add another 4 bytes due to byte alignment.</p>","arenanet":false},{"pubDate":"2013-08-31T08:42:15.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2739236","author":"Wothor.4781","body":"\n<p>Hm, depending on what high frequency is the target, one could think about just using another transport mechanism for those, e.g. a “GWLink”, to meet the requirement of rare updates set by Mumble.<br>\nPersonally I prefer the context blob method over the JSON string.<br>\nThe last char of the character name being a null char? Putting that there should avoid messing up the mumble default gui with the data which would be nice indeed.<br>\nI guess in_combat could be added to state, saving a byte.</p>","arenanet":false},{"pubDate":"2013-08-30T20:10:59.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Mumble-Link-Suggestions-Downed-InCombat-etc/2735603","author":"Talus.1402","body":"\n<p><strong>Hello everyone.</strong>  The reason for this post is to make some suggestions for the information contained in the mumble link data, namely the <em>Identity</em> field.</p>\n<p>I have two suggestions:</p>\n<ol>\n\t<li>Changing the kinds of data stored in the Identity field.</li>\n\t<li>Changing the format of the Identity field.</li>\n</ol>\n<p><ins><strong>Additions and Removals in Current Implementation</strong></ins></p>\n<p>Currently the identity field is in JSON format and looks like:<br>\n{<br>\n  “name”: <em>“John Doe”</em>,<br>\n  “profession”: <em>1</em>,<br>\n  “map_id”: <em>50</em>,<br>\n  “world_id”: <em>1006</em>,<br>\n  “team_color_id”: <em>9</em>,<br>\n  “commander”: <em>true</em><br>\n}</p>\n<p>What we’ve been given is pretty awesome already.  However, I find myself wanting a bit more information about a player’s status.</p>\n<p><strong>Here are some of my suggestions for additional information to be included in the identity field:</strong></p>\n<ul>\n\t<li>health (a 32-bit integer should work): health of character</li>\n\t<li>supply (a 32-bit unsigned integer): supply being carried by character</li>\n\t<li>in_combat (true or false)</li>\n\t<li>state (0 = up, 1 = downed, 2 = defeated)</li>\n\t<li>is_capturing (true or false): true if character is taking an objective, for example a capture point in PvP or a camp in WvW</li>\n</ul>\n<p>My other suggestions are shown in the attached image.  Note that items H through L are some pieces of information others might want to know.</p>\n<p><strong>Here are my suggestions for removal of redundant information from the identity field due to their inclusion in the context field:</strong></p>\n<ul>\n\t<li>map_id</li>\n\t<li>world_id</li>\n</ul>\n<p><ins><strong>Reformatting the Identity Field for Use in High Frequency Retrieval</strong></ins></p>\n<p>Since the health, combat status, and state are things that could very well change quite frequently, I propose a new format for the identity field similar to the way the context field is defined: using set field lengths and byte offsets instead of a JSON string.  The 512-byte identity field has a lot of room left to implement the new format.</p>\n<p>This will allow developers to read data directly from the memory-mapped file instead of having to parse the JSON string prior to retrieving what they need.  Also, character names are limited to 19 characters, so representing it as an array of 20 2-byte wchar_t’s (total of 40 bytes of data) should suffice.</p>\n<p><strong>Attached is my proposed layout.  Let me know what you think!</strong></p>","arenanet":false}]}