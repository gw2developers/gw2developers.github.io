{"title":"Maps API for Leaflet. Need help.","pubDate":"2015-07-08T05:07:24.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Maps-API-for-Leaflet-Need-help","comments":[{"pubDate":"2015-07-10T16:33:46.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Maps-API-for-Leaflet-Need-help/5267836","author":"ezd.6359","body":"\n<p>Bug? Hehe. I think it is a nice thing<img src=\"/include/images/smilies/smile.png\"> Much better than useless grey background. So, should i write my own code to reproduce this “bug” or leaflet has an option for it?</p>","arenanet":false},{"pubDate":"2015-07-09T17:00:48.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Maps-API-for-Leaflet-Need-help/5264465","author":"smiley.1438","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on July 08 2015 11:23PM\"><a href=\"/forum/community/api/Maps-API-for-Leaflet-Need-help/5262388\">ezd.6359:</a></cite></div><div class=\"quotey\"><p>One more question: is it possible to restrict leaflet from zooming out of “max bounds”? It is working in old version of leaflet by default</p></div></blockquote>\n<p>I’m pretty sure that was the <del>feature</del> bug which caused the map to jump on the screen on low zoom levels when it was smaller than the element which contained it. This has been fixed in more recent versions.</p>\n<p>Edit: here’s an example: <a href=\"http://gw2.chillerlan.net/examples/gw2-maps-leaflet.html\">http://gw2.chillerlan.net/examples/gw2-maps-leaflet.html</a></p>","arenanet":false},{"pubDate":"2015-07-08T23:23:25.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Maps-API-for-Leaflet-Need-help/5262388","author":"ezd.6359","body":"\n<p>Thx! I will try to adapt my code.</p>\n<p>It seems i need to make my own list of continents/floors/regions/maps.</p>\n<p>One more question: is it possible to restrict leaflet from zooming out of “max bounds”? It is working in old version of leaflet by default<br>\nleaflet.js (0.5.1) <a href=\"http://jsfiddle.net/cliff/CRRGC/\">http://jsfiddle.net/cliff/CRRGC/</a><br>\nLatest stable version is 0.7.3 – <a href=\"https://jsfiddle.net/CRRGC/947/\">https://jsfiddle.net/CRRGC/947/</a> – you can zoom to max.</p>","arenanet":false},{"pubDate":"2015-07-08T15:06:56.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Maps-API-for-Leaflet-Need-help/5260756","author":"smiley.1438","body":"\n<p>This forum’s software sucks. &lt;.&lt;<br>\nIt sucks so hard that i’ve written my reply in markdown.</p>\n<p><a href=\"https://gist.github.com/codemasher/50d75a36d28558231a92\">https://gist.github.com/codemasher/50d75a36d28558231a92</a></p>\n<p>(yes, i’m desperate)</p>","arenanet":false},{"pubDate":"2015-07-08T05:07:25.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Maps-API-for-Leaflet-Need-help/5259457","author":"ezd.6359","body":"\n<p>Lost two days. Can’t understand what to do :/ Help?</p>\n<p><strong>1) How to determine right coords/bounds? I want to change focus of the map with java scripts outside of the map.</strong></p>\n<p>For example i load <a href=\"https://api.guildwars2.com/v2/continents/1/floors/1\">https://api.guildwars2.com/v2/continents/1/floors/1</a> it looks like right place to show Tyria.</p>\n<p>I can use sectors coords to focus the map in right position.</p>\n<pre><code>\nvar bounds=new L.LatLngBounds(\n    this.map.unproject([0,32768],max_zoom),\n    this.map.unproject([32768, 0],max_zoom)\n);\nthis.map.setMaxBounds(bounds);\n...\nthis.map.setView(pos);\nthis.map.panTo(this.map.unproject(pos,zoom)).setZoom(zoom);\n</code></pre>\n<p>…</p>\n<p>If i try to use “clamp” (continent_rect of the map), i can’t focus to right position.</p>\n<pre><code>\nvar bounds=new L.LatLngBounds(\n    this.map.unproject([continent_rect[0][0],continent_rect[0][1]],max_zoom),\n    this.map.unproject([continent_rect[1][0],continent_rect[1][1]],max_zoom)\n).pad(0.2);\nthis.map.setMaxBounds(bounds);\n...\nthis.map.setView(pos);\nthis.map.panTo(this.map.unproject(pos,zoom)).setZoom(zoom);\n</code></pre>\n<p>…<br>\n… sectors coords move the map to wrong place. I don’t understand it. How to translate maps api coords/map_rect/continent_rect to right form (for leaflet)?</p>\n<p><strong>2) How to show right map names? Or how to show maps from different regions?</strong></p>\n<p>a) Since API does not provide “label_coords” for map names i try to calculate right position using continent_rect. It works, but some regions have too many maps (and names), it makes “map name” unusable because they lie in same place. How to filter wrong names?<br>\n</p><pre><code>\nX=(info['continent_rect'][1][0]-info['continent_rect'][0][0])/2+info['continent_rect'][0][0],\nY=(info['continent_rect'][1][1]-info['continent_rect'][0][1])/2+info['continent_rect'][0][1]\n</code></pre>For example i use “continent/1/floor/1”. Region=8 has many maps and it fail everything. All these names lie in same place (corresponding map).<p></p>\n<p><a href=\"https://api.guildwars2.com/v2/continents/1/floors/1/regions/8\">https://api.guildwars2.com/v2/continents/1/floors/1/regions/8</a><br>\nIt looks like it: <a href=\"http://i.gyazo.com/e25894fbd3bfd4e4828e15be544df413.png\">http://i.gyazo.com/e25894fbd3bfd4e4828e15be544df413.png</a></p>\n<p><strong>3) How to show those maps from region 8? They have same parameters (continent/floor/rect) as normal maps.</strong></p>\n<p>How to filter dungeons or special events maps etc?</p>\n<p>I need (only default floors):<br>\n- Tyria maps <br>\n- Main dungeons<br>\n- WvWvW</p>\n<p><strong>4) Is there any list/API that can map GW2 API info -&gt; usuable info?<img src=\"/include/images/smilies/smile.png\"></strong></p>\n<p>Like:<br>\n</p><pre><code>\nTyria:{\n    regions{\n        maps: {\n            continent_id=1\n            floor_id=1\n            center=coords\n            default_zoom=X\n            label_coords=coords\n            ...\n        }\n    }\n}\nDuangeons:{\n    maps: {\n        Ascalonian Catacoms\n             ...\n    }\n}\n</code></pre><p></p>\n<p>All items should be in one instance. At this moment API provides duplicate names. For example<br>\n<a href=\"https://api.guildwars2.com/v2/continents/1/floors/-2/regions/2/maps/33\">https://api.guildwars2.com/v2/continents/1/floors/-2/regions/2/maps/33</a><br>\n<a href=\"https://api.guildwars2.com/v2/continents/1/floors/-2/regions/2/maps/36\">https://api.guildwars2.com/v2/continents/1/floors/-2/regions/2/maps/36</a></p>\n<p>Which is right? How to understand it automatically without having special lists of ids, continents, floors etc?</p>","arenanet":false}]}