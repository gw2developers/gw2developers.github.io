{"title":"ErrBadParam in google spreadsheets","pubDate":"2017-03-12T15:36:06.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/ErrBadParam-in-google-spreadsheets","comments":[{"pubDate":"2017-03-13T14:47:47.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/ErrBadParam-in-google-spreadsheets/6526420","author":"SlippyCheeze.5483","body":"\n<p>Your issue is something specific in the Google Apps script, rather than the URL; since you supplied the API key I was able to verify that it works, and returns data, manually.</p>\n<p>Have you tried dumping the body of the response object, which may contain more details?  Anyway, ultimately, this is a “local code” issue, not an API issue.  Sorry.</p>","arenanet":false},{"pubDate":"2017-03-13T13:13:01.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/ErrBadParam-in-google-spreadsheets/6526352","author":"Grax.9204","body":"\n<p>Thanks for the tip.</p>\n<p>Here’s what I tried:</p>\n<pre><code>\nvar apiKey = \"9EBFF0A1-988B-9C41-8E52-DFE622E774967324E1F7-AAA2-4837-974A-B42B312263B6\";\nvar url = 'https://api.guildwars2.com/v2/account/bank?access_token=' + apiKey;\n  \nvar options = {\n  \"method\": \"GET\",\n  \"contentType\": \"application/json\",\n  \"muteHttpExceptions\": true\n};\nvar response = UrlFetchApp.fetch(url, options);\n\n</code></pre>\n<p>Same result, the response I get is “ErrBadParam”.</p>","arenanet":false},{"pubDate":"2017-03-13T12:13:24.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/ErrBadParam-in-google-spreadsheets/6526301","author":"DragonHeart.7201","body":"\n<p>You might have to set the headers correctly to fetch the data.</p>\n<p>var options = { };<br>\noptions[“method”] = “GET”;<br>\noptions[“contentType”] = “application/json”;</p>\n<p>var response = UrlFetchApp.fetch(url, options);</p>\n<p>Not sure if this will solve your issue, worth a shot.</p>","arenanet":false},{"pubDate":"2017-03-12T15:36:07.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/ErrBadParam-in-google-spreadsheets/6525444","author":"Grax.9204","body":"\n<p>Hello there</p>\n<p>I’m having an issue retrieving data from the authenticated API endpoints in a google spreadsheet.</p>\n<p>Here’s the code that causes issues:</p>\n<pre><code>\nvar url = 'https://api.guildwars2.com/v2/account/bank?access_token=' + apiKey;\nvar response = UrlFetchApp.fetch(url);\n\n</code></pre>\n<p>The error I get: “ErrBadParam”.</p>\n<p>When using the exact same URL as well as API-Key in my browser, I get the expected JSON result.<br>\nAccessing unauthenticated endpoints with the same code, without the access token, works as well.</p>\n<p>What am I missing?</p>","arenanet":false}]}