{"title":"Item details class design","pubDate":"2014-09-27T08:41:36.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Item-details-class-design","comments":[{"pubDate":"2014-10-03T13:26:26.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Item-details-class-design/4463232","author":"AysonCurrax.3254","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on September 27 2014 08:41AM\"><a href=\"/forum/community/api/Item-details-class-design/4448869\">StevenL.3761:</a></cite></div><div class=\"quotey\"><p>For /v1, I used to have a single class per item type to hold type-specific item details.</p>\n<p>Statically typed languages like C# do not allow “item.details” objects to take on different types according to the value of “item.type”.</p>\n<p>For /v2, I need to rethink my design so that every possible item detail fits into a single class hierarchy.</p>\n<p>Is anyone trying to do the same thing? Did you run into any problems with things like duplicate property names meaning different things for different item types?</p>\n<p><strong>edit</strong></p>\n<p>Does anyone use JSON schema validation? Is there a way to generate an aggregate schema from a number of different json documents? It would be interesting to see a tool that loops through all 38k items, then outputs a complete schema that describes all possible objects and properties.</p></div></blockquote>\n<p>I am currently in the same boat, although i am using Java on my end. My first thought was to have a default “Details” class and then derive other classes from that class for example “DetailsArmor” and “DetailsWeapon” with the respective attributes in them.</p>\n<p>I am doubtful that that will work though. previously, I had One class “ItemJSON” with several static subclasses in that class so i could directly Map item_details onto that class and then use the getters and setters to map that onto my more specific objects that go along with my database structure.</p>\n<p>So in that case, i would have “ItemJSON.Armor” contain all the info from the “Armor” subobject from the item_details json.</p>\n<p>I could have details contain all possible attributes, thus making everything not used NULL, but that would be too lazy and dirty for my taste. Like that one time where i mapped Item_details onto a single database table which ended up having 100 or so columns with several hundred thousand entries. -cough-</p>","arenanet":false},{"pubDate":"2014-09-29T18:16:42.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Item-details-class-design/4453659","author":"Pat Cavit.9234","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on September 28 2014 01:22AM\"><a href=\"/forum/community/api/Item-details-class-design/4450378\">poke.3712:</a></cite></div><div class=\"quotey\"><p>I looked at all items, and ended up with <a href=\"http://wiki.guildwars2.com/wiki/API:2/items\">the documentation</a>. Hope it helps<img src=\"/include/images/smilies/smile.png\"></p></div></blockquote>\n<p>This is so great. Thanks poke!</p>","arenanet":true},{"pubDate":"2014-09-28T09:27:26.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Item-details-class-design/4450911","author":"StevenL.3761","body":"\n<p>I would prefer schemas over custom converters. I think that you could write a schema that only matches objects with a specific value for the “type” property. So you’d write one schema for each possible type, then use those schemas to determine which class to use for serialization.</p>\n<p>Your documentation was very helpful though. In the end, I ended up with this class layout: <a href=\"https://gw2dotnet.codeplex.com/SourceControl/latest#GW2.NET/Code/GW2.NET.Core/V2/Items.Json/DetailsDataContract.cs\">https://gw2dotnet.codeplex.com/SourceControl/latest#GW2.NET/Code/GW2.NET.Core/V2/Items.Json/DetailsDataContract.cs</a></p>","arenanet":false},{"pubDate":"2014-09-28T01:22:49.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Item-details-class-design/4450378","author":"poke.3712","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on September 27 2014 08:41AM\"><a href=\"/forum/community/api/Item-details-class-design/4448869\">StevenL.3761:</a></cite></div><div class=\"quotey\"><p>Statically typed languages like C# do not allow “item.details” objects to take on different types according to the value of “item.type”.</p></div></blockquote>\n<p>While that is true, you could still have some abstract `ItemDetails` type that has various different implementations depending on the item type. Or even better, have a base `Item` type and make a subtype for each item type that extends the type by those additional properties in the `details` object. That way, you would also get a proper type in C# (and wouldn’t need to check the item’s `type` value).</p>\n<p>Depending on how you are parsing the JSON, you might be able to put this into a custom parser that creates the proper subtype depending on the `type` value.</p>\n<blockquote><div class=\"citey\"><cite title=\"Posted on September 27 2014 08:41AM\"><a href=\"/forum/community/api/Item-details-class-design/4448869\">StevenL.3761:</a></cite></div><div class=\"quotey\"><p>Does anyone use JSON schema validation?</p></div></blockquote>\n<p>JSON schema validation was invented by XML people who thought they would need to add whatever XML had as JSON replaced XML in web services. But JSON was meant as a dynamic format, so having a schema doesn’t really make sense to me…</p>\n<blockquote><div class=\"citey\"><cite title=\"Posted on September 27 2014 08:41AM\"><a href=\"/forum/community/api/Item-details-class-design/4448869\">StevenL.3761:</a></cite></div><div class=\"quotey\"><p>It would be interesting to see a tool that loops through all 38k items, then outputs a complete schema that describes all possible objects and properties.</p></div></blockquote>\n<p>I looked at all items, and ended up with <a href=\"http://wiki.guildwars2.com/wiki/API:2/items\">the documentation</a>. Hope it helps<img src=\"/include/images/smilies/smile.png\"></p>","arenanet":false},{"pubDate":"2014-09-27T08:41:36.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Item-details-class-design/4448869","author":"StevenL.3761","body":"\n<p>For /v1, I used to have a single class per item type to hold type-specific item details.</p>\n<p>Statically typed languages like C# do not allow “item.details” objects to take on different types according to the value of “item.type”.</p>\n<p>For /v2, I need to rethink my design so that every possible item detail fits into a single class hierarchy.</p>\n<p>Is anyone trying to do the same thing? Did you run into any problems with things like duplicate property names meaning different things for different item types?</p>\n<p><strong>edit</strong></p>\n<p>Does anyone use JSON schema validation? Is there a way to generate an aggregate schema from a number of different json documents? It would be interesting to see a tool that loops through all 38k items, then outputs a complete schema that describes all possible objects and properties.</p>","arenanet":false}]}