{"title":"JS script - servers with available temples","pubDate":"2013-05-23T17:59:00.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/JS-script-servers-with-available-temples","comments":[{"pubDate":"2013-05-23T18:14:44.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/JS-script-servers-with-available-temples/2079776","author":"DarkSpirit.7046","body":"\n<p>Unfortunately, some of the comment lines were truncated.  Anyway here are the event ids:</p>\n<p>“0723E056-E665-439F-99B7-20385442AD4E”; // “Protect the Cathedral of Zephyrs.” – Dwayna<br>\n“0372874E-59B7-4A8F-B535-2CF57B8E67E4”; // “Kill the Corrupted High Priestess” – Lyssa<br>\n“989A298C-B06B-4E9B-A871-1506A6EE3FEC”; // “Defend the Pact interrupter from Risen attacks.” – Melandru<br>\n“DFBFF5FE-5AF0-4B65-9199-B7CACC945ABD”; // “Ensure that the Pact holds the Gates of Arah.” – Arah<br>\n“57A8E394-092D-4877-90A5-C238E882C320”; // “Stop the Risen Priest of Grenth from retaking the Cathedral of Silence.” – Grenth<br>\n“589B1C41-DD96-4AEE-8A3A-4CC607805B05”; // “Help the Pact hold the Altar of Betrayal from the Risen.” – Balthazar</p>\n<p>The discussion was held on this thread:</p>\n<p><a href=\"https://forum-en.guildwars2.com/forum/community/api/Inaccurate-API-response-for-events/first#post2079579\">https://forum-en.guildwars2.com/forum/community/api/Inaccurate-API-response-for-events/first#post2079579</a></p>","arenanet":false},{"pubDate":"2013-05-23T17:59:00.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/JS-script-servers-with-available-temples/2079691","author":"DarkSpirit.7046","body":"\n<p>Here is a fast hack of a windows scripting host scriplet to list the servers with temples that are cleared by checking their corresponding Defense events.</p>\n<p>To run it, just copy and paste these 2 files in the same directory.  Also download json2.js from the internet into the same directory.  Then type this in a cmd box:</p>\n<p>cscript events.wsf</p>\n<p>events.wsf:</p>\n<pre><code>\n&lt;job id=\"gw2events\"&gt;\n\t&lt;Script type=\"text/javascript\" src=\"json2.js\" /&gt;\n        &lt;Script type=\"text/javascript\" src=\"gw2events.js\" /&gt;\n\t&lt;script type=\"text/javascript\"&gt;\n\t\tvar api = new GW2EVENTS();\n\t\tvar eventNames = api.EventNames();\n\t\tvar worldNames = api.WorldNames();\n\t\tvar mapNames = api.MapNames();\n\n\t\t//var eventIdToCheck = \"0723E056-E665-439F-99B7-20385442AD4E\"; // \"Protect the Cathedral of Zephyrs.\" - Dwayna\n\n\t\t//var eventIdToCheck = \"0372874E-59B7-4A8F-B535-2CF57B8E67E4\"; // \"Kill the Corrupted High Priestess\" - Lyssa\n\n\t\t//var eventIdToCheck = \"989A298C-B06B-4E9B-A871-1506A6EE3FEC\"; // \"Defend the Pact interrupter from Risen attacks.\" - Melandru\n\n\t\t//var eventIdToCheck = \"DFBFF5FE-5AF0-4B65-9199-B7CACC945ABD\"; // \"Ensure that the Pact holds the Gates of Arah.\" - Arah\n\n\t\t//var eventIdToCheck = \"57A8E394-092D-4877-90A5-C238E882C320\"; // \"Stop the Risen Priest of Grenth from retaking the Cathedral of \n\nSilence.\" - Grenth\n\n\t\t//var eventIdToCheck = \"9752677E-FAE7-4F56-A48A-275329095B8A\"; // \"Hold the Infinity Coil.\" - CoE\n\n\t\tvar eventIdToCheck = \"589B1C41-DD96-4AEE-8A3A-4CC607805B05\"; // \"Help the Pact hold the Altar of Betrayal from the Risen.\" - Balthazar\n\t\t\n\t\tfor (var i in worldNames) {\n\t\t\tif (api.IsUSWorld(worldNames[i])) {\n\t\t\t\tvar events = api.Events(worldNames[i].id, eventIdToCheck)\n\t\t\t\tfor (var j in events) {\n\t\t\t\t\tif (events[j].state != \"Fail\") {\n\t\t\t\t\t\tWScript.Echo(api.Name(worldNames,worldNames[i].id) + \" \" + events[j].state);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t&lt;/script&gt;\n&lt;/job&gt;\n</code></pre>\n<p>gw2events.js:</p>\n<pre><code>\nxmlhttp = new ActiveXObject(\"Msxml2.XMLHTTP\");\n\nfunction GW2EVENTS()\n{\n\tthis.Name = getName;\n    \tthis.EventNames = getEventNames;\n\tthis.MapNames = getMapNames;\n\tthis.WorldNames = getWorldNames;\n\tthis.Events = getEvents;\n\tthis.IsUSWorld = IsUSWorld;\n\tthis.IsEuropeWorld = IsEuropeWorld;\n\n\tfunction getName(list, id)\n\t{\n\t\tfor (var i in list) {\n\t\t\tif (list[i].id == id) return list[i].name;\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\tfunction IsUSWorld(world)\n\t{\n\t\treturn (world.id.charAt(0) == '1');\n\t}\n\n\tfunction IsEuropeWorld(world)\n\t{\n\t\treturn (world.id.charAt(0) == '2');\n\t}\n\n        function getEventNames()\n\t{\n\t       return _request('event_names.json');\n\t}\n\n\tfunction getMapNames()\n\t{\n   \t\treturn _request('map_names.json');\n\t}\n\n        function getWorldNames()\n        {\n\t\treturn _request('world_names.json');\n        }\n\n\tfunction getEvents(worldId, eventId)\n\t{\n\t\tvar param = \"\", param2 = \"\";\n\n\t\tif (typeof worldId != \"undefined\") {\n\t\t\tparam = \"world_id=\" + worldId;\n\t\t}\n\t\tif (typeof eventId != \"undefined\") {\n\t\t\tparam2 = \"event_id=\" + eventId;\n\t\t}\n\t\treturn _request('events.json?', param, param2).events;\n\t}\n\n\tfunction _request()\n\t{\n\t\tvar args = Array.prototype.slice.call(arguments)\n\t\ttry {\n\t\t\t_HttpGet(args);\n\t\t}\n\t\tcatch (e)\n\t\t{\t\n\t\t\tWScript.Echo (\"Error: \" + e.number);\t\n                        WScript.Echo (\"Retrying...\");\n\n\t\t\ttry {\n\t\t\t\t_HttpGet(args);\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tWScript.Echo (\"Error: \" + e.number);\n\t\t\t}\t\n\t\t}\n\t\t\t\n\t\ttry {\n\t\t\tvar outputString = _JSONParse();\n\t\t}\n\t\tcatch(e) \n\t\t{\n\t\t\tWScript.Echo (\"JSON parsing error!  Retrying...\");\n\t\t\t_HttpGet(args);\n\t\t\tvar outputString = _JSONParse();\n\t\t}\n         \treturn(outputString);\n\t}\n\n\tfunction _HttpGet(args)\n\t{\n\t\txmlhttp.open(\"GET\", \"https://api.guildwars2.com/v1/\" + args.join(\"&amp;\"), false);\t\t\t\t\n\t\txmlhttp.send();\t\n\t}\n\n\tfunction _JSONParse()\n\t{\n\t\tvar parseString = xmlhttp.responseText;\n\t\treturn JSON.parse(parseString);\n\t}\n}</code></pre>","arenanet":false}]}