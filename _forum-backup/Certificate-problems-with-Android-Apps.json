{"title":"Certificate problems with Android Apps","pubDate":"2013-06-16T23:06:00.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps","comments":[{"pubDate":"2013-06-21T01:59:35.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2252304","author":"Rurik Telmonkin.3648","body":"\n<p>Well huzzah, with the change to 2.3.3, it is pulling in data just fine. Now just to work out all the other bugs and issues that will undoubtedly occur. But that is for me to figure out on my own<img src=\"/include/images/smilies/smile.png\"> thanks all</p>","arenanet":false},{"pubDate":"2013-06-21T01:21:33.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2252127","author":"Varonth.5830","body":"\n<p>You don’t need a StartCom SSLSocketFactory anymore.<br>\nIn fact, the socket factory generated by my SSL Helper class sets up factories which provide SSL sockets for a single certificate.<br>\nIf the server you are connecting to isn’t using that certificate directly or as part of its certificate chain, than these sockets will refuse the connection (which in that case is the correct behavior for these sockets).</p>\n<p>With the change to GeoTrust from StartCom as certificate authority StartCom SSLSockets will refuse the connection.</p>\n<p>Instead you can just use the default SSLSocketFactory of your java implementation (GeoTrust should really be included in any Java implementation, including the Dalvik VM used by Android).<br>\nLatest version, which I uploaded does exactly that, and it works just fine.</p>","arenanet":false},{"pubDate":"2013-06-20T23:45:06.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2251511","author":"Rurik Telmonkin.3648","body":"\n<p>Well, after re-enabling file based cert files it has, instead of catching errors and running ahead, is crashing.</p>\n<p>I am using the original version of jGW2API as my base for api calls, with the only major difference being the following lines in the StartComSSLSocketFactory.java:</p>\n<p>private static Context thisContext = MenuActivity.context;</p>\n<p>private StartComSSLSocketFactory() <br>\n     throws CertificateException, NoSuchAlgorithmException,<br>\n     KeyStoreException, IOException, KeyManagementException {<br>\n        super(readTxt()/<strong>StartComSSLSocketFactory.StartComRootCertificate</strong>/, “StartCom”, “X.509”, “X509”);<br>\n        this.sslSocketFactory = this.sslCon.getSocketFactory();<br>\n    }<br>\n    <br>\n    private static InputStream readTxt() throws IOException{<br>\n    \t//AssetManager res = thisContext.getAssets();<br>\n    \tInputStream in = thisContext.getAssets().open(“ca.pem”);<br>\n    \treturn in;<br>\n    }</p>\n<p>and the problem seems to be that it cannot see the ca.pem file, despite it being in the assets folder. Until I figure out why its not finding that file, I won’t be able to see if it was my running on 2.2 that was affecting it.</p>\n<p>The obvious solution to this, is to redo my project using sdk 2.3+ as the minimum, but I would rather not do that if avoidable</p>\n<p>EDIT:<br>\nWell somehow I just managed to screw up and lose all my work, so I am gonna start again on gingerbread sdk, hopefully I wont run into these problems again</p>","arenanet":false},{"pubDate":"2013-06-20T22:16:03.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2250825","author":"Rurik Telmonkin.3648","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on June 20 2013 01:55PM\"><a href=\"/forum/community/api/Certificate-problems-with-Android-Apps/2247069\">Cliff Spradlin.3512:</a></cite></div><div class=\"quotey\"><blockquote><div class=\"citey\"><cite title=\"Posted on June 20 2013 07:50AM\"><a href=\"/forum/community/api/Certificate-problems-with-Android-Apps/2245639\">Rurik Telmonkin.3648:</a></cite></div><div class=\"quotey\"><p>Hmm interesting, it seems is was failing on the first call, it just wasnt notifying me because the second call overwrote it. So for some reason, all my calls to the api are failing with an IOException in my android app, with a warning of an SSL Exception saying No Trusted Server Certificate, and a CertificateException stating that TrustAnchor for CertPath not found.</p>\n<p>Whats strange is that these work perfectly on the pc version of the app and I just dont know what could be going wrong.</p></div></blockquote>\n<p>Can you post the code relevant to setting up SSL and connecting to the API?</p>\n<p>Also, what happens when you visit an API url on your mobile browser? Is there a certificate error?</p></div></blockquote>\n<p>It works fine on my mobile browser, I assume because of what Healix said below, that my app is running on 2.2 which doesn’t support geotrust naturally, but I can get around that easy enough.</p>","arenanet":false},{"pubDate":"2013-06-20T22:12:37.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2250793","author":"Rurik Telmonkin.3648","body":"\n<p>Thank you Healix, that would be the problem, I have minimum sdk set to 2.2.</p>\n<p>I will try out that cert later and hopefully it will work.</p>","arenanet":false},{"pubDate":"2013-06-20T16:23:35.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2247902","author":"Healix.5819","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on June 20 2013 07:50AM\"><a href=\"/forum/community/api/Certificate-problems-with-Android-Apps/2245639\">Rurik Telmonkin.3648:</a></cite></div><div class=\"quotey\"><p>Whats strange is that these work perfectly on the pc version of the app and I just dont know what could be going wrong.</p></div></blockquote>\n<p>I’m assuming the “pc version” is basically the same program and not an entirely different one? If your Android device is version 2.2 or below, it doesn’t trust GeoTrust’s certificate. It should however trust their old (Equifax) certificate, in which case ArenaNet could update theirs to point to that one as a workaround (<a href=\"http://www.geocerts.com/support/cross_root\">http://www.geocerts.com/support/cross_root</a>).</p>\n<p>And here’s a workaround for you:</p>\n<p>Download <a href=\"http://www.geotrust.com/resources/root-certificates/\">GeoTrust Global CA</a> certificate (or, <a href=\"http://www.geotrust.com/resources/root_certificates/certificates/GeoTrust_Global_CA.pem\">direct pem link</a>) and place it in your resources.<br>\nWhen creating the HTTPS connection, set it up to trust that CA.</p>\n<p>An example can be found in the tutorial (Unknown certificate authority):<br>\n<a href=\"http://developer.android.com/training/articles/security-ssl.html#UnknownCa\">http://developer.android.com/training/articles/security-ssl.html#UnknownCa</a></p>","arenanet":false},{"pubDate":"2013-06-20T15:27:04.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2247620","author":"Goddchen.4958","body":"\n<p>Rurik, you might want to check out some of my source code on how to access the API from Android: <a href=\"https://github.com/Goddchen/GuildWars2-API-Explorer/blob/master/GuildWars2APIExplorer/src/main/java/de/goddchen/android/gw2/api/async/MapNamesLoader.java\">https://github.com/Goddchen/GuildWars2-API-Explorer/blob/master/GuildWars2APIExplorer/src/main/java/de/goddchen/android/gw2/api/async/MapNamesLoader.java</a></p>","arenanet":false},{"pubDate":"2013-06-20T13:55:32.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2247069","author":"Cliff Spradlin.3512","body":"\n<blockquote><div class=\"citey\"><cite title=\"Posted on June 20 2013 07:50AM\"><a href=\"/forum/community/api/Certificate-problems-with-Android-Apps/2245639\">Rurik Telmonkin.3648:</a></cite></div><div class=\"quotey\"><p>Hmm interesting, it seems is was failing on the first call, it just wasnt notifying me because the second call overwrote it. So for some reason, all my calls to the api are failing with an IOException in my android app, with a warning of an SSL Exception saying No Trusted Server Certificate, and a CertificateException stating that TrustAnchor for CertPath not found.</p>\n<p>Whats strange is that these work perfectly on the pc version of the app and I just dont know what could be going wrong.</p></div></blockquote>\n<p>Can you post the code relevant to setting up SSL and connecting to the API?</p>\n<p>Also, what happens when you visit an API url on your mobile browser? Is there a certificate error?</p>","arenanet":true},{"pubDate":"2013-06-20T07:50:52.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2245639","author":"Rurik Telmonkin.3648","body":"\n<p>Hmm interesting, it seems is was failing on the first call, it just wasnt notifying me because the second call overwrote it. So for some reason, all my calls to the api are failing with an IOException in my android app, with a warning of an SSL Exception saying No Trusted Server Certificate, and a CertificateException stating that TrustAnchor for CertPath not found.</p>\n<p>Whats strange is that these work perfectly on the pc version of the app and I just dont know what could be going wrong.</p>","arenanet":false},{"pubDate":"2013-06-19T22:41:32.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2243664","author":"Rurik Telmonkin.3648","body":"\n<p>Yes, the new certificate fixed the pc version issues certainly. However my android version is still giving me warnings about not having a secure ssl cert, as well as an IOException when grabbing world names. I suspect that the latter is the null world causing issues.</p>\n<p>EDIT<br>\nhmm, it seems to definitely be a server issue that I cannot change or fix on my end, as the IO exception is being caused by this.httpsConnection.getInputStream().</p>\n<p>I know its not an issue on my end as I use the same thing for two different calls and only one is failing, that being the one grabbing world names.</p>","arenanet":false},{"pubDate":"2013-06-19T17:16:07.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2241449","author":"Yamagawa.5941","body":"\n<p>Updates in the other thread.  They got a new key issued from a more widely accepted root authority.  You can probably axe most/All your SSL specific code.<br>\n//Yamagawa</p>","arenanet":false},{"pubDate":"2013-06-19T05:19:18.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2238004","author":"Rurik Telmonkin.3648","body":"\n<p>No its definitely not on my end, as my precompiled (weeks ago) program wont work either. Something is definitely going wrong with the server, and it is probably the Worlds List bug.</p>\n<p>Or it could be the new certificate they are running, interesting. (probably it, as the old hard coded certificate in my pc program would no longer be correct)</p>","arenanet":false},{"pubDate":"2013-06-19T03:49:04.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2237693","author":"Yamagawa.5941","body":"\n<p>I don’t think it’s you.  Or rather, I don’t think you caused the error:<br>\n<a href=\"https://forum-en.guildwars2.com/forum/community/api/HTTP-access/first#post2236704\">https://forum-en.guildwars2.com/forum/community/api/HTTP-access/first#post2236704</a></p>","arenanet":false},{"pubDate":"2013-06-19T03:26:19.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2237603","author":"Rurik Telmonkin.3648","body":"\n<p>Hmm so I dont know whats happened, but since fixing this issue, my pc application version no longer works, with a:</p>\n<p>PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target error.</p>\n<p>while my android app is once again having problems, but this time an IO exception with logcat giving a warning that there is an SSLException, stating Not Trusted Server Certificate… android frustrates me</p>","arenanet":false},{"pubDate":"2013-06-18T12:42:41.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2233036","author":"Goddchen.4958","body":"\n<p>HttpsURLConnection seems to be able to handle the HTTPS connection just fine without any further config.</p>","arenanet":false},{"pubDate":"2013-06-18T08:29:33.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2232211","author":"Rurik Telmonkin.3648","body":"\n<p>Never mind, google did the trick. Thanks for the help. Now I will just need to work on speeding it up somehow.</p>","arenanet":false},{"pubDate":"2013-06-18T04:47:50.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2231551","author":"Rurik Telmonkin.3648","body":"\n<p>Strange, I was under the assumption that with it being a https: connection, it would require a certificate, also I am pretty sure it gave me troubles when i tried to connect without a certificate.</p>\n<p>But I will give it a try and see what happens.</p>\n<p>As a side not, where in the manifest should I put the INTERNET tag?</p>","arenanet":false},{"pubDate":"2013-06-17T23:39:28.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2230559","author":"Tanis.5134","body":"\n<p>I am successfully using the API in an Android app without manually specifying or installing a certificate.</p>","arenanet":false},{"pubDate":"2013-06-17T10:27:41.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2226953","author":"Rasman.7812","body":"\n<p>I had the same problem, so i just deleted the certificate. That worked for me.<br>\nAlso remember to add the INTERNET persmission in your manifest file.</p>","arenanet":false},{"pubDate":"2013-06-16T23:06:00.000Z","guid":"http://forum-en.guildwars2.com/forum/community/api/Certificate-problems-with-Android-Apps/2224748","author":"Rurik Telmonkin.3648","body":"\n<p>Hey all,</p>\n<p>So here is my problem. I wrote a program using the api, as a desktop application, and it all worked fine, no problems.</p>\n<p>I decided to expand it and turn it into an android application as well. The program still works as a desktop application but when I try to run it as an android application, it has problems with the certificate.</p>\n<p>I have tried using both jGW2API’s hard coded certificate, and the attached ca.cer file for my certificate, but both times the logcat tells me that there is not enough data in the certificate(input stream to be specific).</p>\n<p>Anyone know why this is happening/how I can solve it?</p>\n<p>Rurik</p>\n<p>subnote: Cannot attach .cer file, changed it into .txt file via editing the extension. I hope this doesnst cause any issues.</p>","arenanet":false}]}